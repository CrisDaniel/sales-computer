Ã
jD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Utilidades\ViewComponents\MenuViewComponent.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %

Utilidades% /
./ 0
ViewComponents0 >
{		 
public

 

class

 
MenuViewComponent

 "
:

# $
ViewComponent

% 2
{ 
private 
readonly 
IMenuService %
_menuServicio& 3
;3 4
private 
readonly 
IMapper  
_mapper! (
;( )
public 
MenuViewComponent  
(  !
IMenuService! -
menuServicio. :
,: ;
IMapper 
mapper 
) 
{ 	
_menuServicio 
= 
menuServicio (
;( )
_mapper 
= 
mapper 
; 
} 	
public 
async 
Task 
<  
IViewComponentResult .
>. /
InvokeAsync0 ;
(; <
)< =
{> ?
ClaimsPrincipal 
	claimUser %
=& '
HttpContext( 3
.3 4
User4 8
;8 9
List 
< 
VMMenu 
> 

listaMenus #
;# $
if 
( 
	claimUser 
. 
Identity "
." #
IsAuthenticated# 2
)2 3
{ 
string 
	idUsuario  
=! "
	claimUser# ,
., -
Claims- 3
. 
Where 
( 
c 
=> 
c  !
.! "
Type" &
==' )

ClaimTypes* 4
.4 5
NameIdentifier5 C
)C D
.   
Select   
(   
c   
=>    
c  ! "
.  " #
Value  # (
)  ( )
.  ) *
SingleOrDefault  * 9
(  9 :
)  : ;
;  ; <

listaMenus"" 
="" 
_mapper"" $
.""$ %
Map""% (
<""( )
List"") -
<""- .
VMMenu"". 4
>""4 5
>""5 6
(""6 7
await""7 <
_menuServicio""= J
.""J K
ObtenerMenus""K W
(""W X
int""X [
.""[ \
Parse""\ a
(""a b
	idUsuario""b k
)""k l
)""l m
)""m n
;""n o
}$$ 
else%% 
{%% 

listaMenus&& 
=&& 
new&&  
List&&! %
<&&% &
VMMenu&&& ,
>&&, -
{&&. /
}&&0 1
;&&1 2
}'' 
return)) 
View)) 
()) 

listaMenus)) "
)))" #
;))# $
}++ 	
}-- 
}.. ÿ
qD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Utilidades\ViewComponents\MenuUsuarioViewComponent.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %

Utilidades% /
./ 0
ViewComponents0 >
{ 
public 

class $
MenuUsuarioViewComponent )
:* +
ViewComponent, 9
{ 
public 
async 
Task 
<  
IViewComponentResult .
>. /
InvokeAsync0 ;
(; <
)< =
{> ?
ClaimsPrincipal 
	claimUser %
=& '
HttpContext( 3
.3 4
User4 8
;8 9
string 
nombreUsuario  
=! "
$str# %
;% &
string 
urlFotoUsuario !
=" #
$str$ &
;& '
if 
( 
	claimUser 
. 
Identity "
." #
IsAuthenticated# 2
)2 3
{4 5
nombreUsuario 
= 
	claimUser  )
.) *
Claims* 0
. 
Where 
( 
c 
=> 
c  !
.! "
Type" &
==' )

ClaimTypes* 4
.4 5
Name5 9
)9 :
. 
Select 
( 
c 
=>  
c! "
." #
Value# (
)( )
.) *
SingleOrDefault* 9
(9 :
): ;
;; <
urlFotoUsuario 
=  
(! "
(" #
ClaimsIdentity# 1
)1 2
	claimUser2 ;
.; <
Identity< D
)D E
.E F
	FindFirstF O
(O P
$strP Y
)Y Z
.Z [
Value[ `
;` a
} 
ViewData 
[ 
$str $
]$ %
=& '
nombreUsuario( 5
;5 6
ViewData 
[ 
$str %
]% &
=' (
urlFotoUsuario) 7
;7 8
return 
View 
( 
) 
; 
}   	
}!! 
}"" É	
bD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Utilidades\Response\GenericResponse.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %

Utilidades% /
./ 0
Response0 8
{ 
public 

class 
GenericResponse  
<  !
TObject! (
>( )
{ 
public 
bool 
Estado 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Mensaje 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
TObject 
? 
Objeto 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
TObject 
> 
? 
ListaObjeto )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
}		 
}

 â
oD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Utilidades\Extensiones\CustomAssemblyLoadContext.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %

Utilidades% /
./ 0
Extensiones0 ;
{ 
public 

class %
CustomAssemblyLoadContext *
:+ ,
AssemblyLoadContext- @
{ 
public 
IntPtr  
LoadUnmanagedLibrary *
(* +
string+ 1
absolutePath2 >
)> ?
{		 	
return

 
LoadUnmanagedDll

 #
(

# $
absolutePath

$ 0
)

0 1
;

1 2
} 	
	protected 
override 
IntPtr !
LoadUnmanagedDll" 2
(2 3
string3 9
unmanagedDllName: J
)J K
{ 	
return $
LoadUnmanagedDllFromPath +
(+ ,
unmanagedDllName, <
)< =
;= >
} 	
	protected 
override 
Assembly #
Load$ (
(( )
AssemblyName) 5
assemblyName6 B
)B C
{ 	
throw 
new #
NotImplementedException -
(- .
). /
;/ 0
} 	
} 
} ıƒ
fD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Utilidades\Automapper\AutoMapperProfile.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %

Utilidades% /
./ 0

Automapper0 :
{ 
public		 

class		 
AutoMapperProfile		 "
:		# $
Profile		% ,
{

 
public 
AutoMapperProfile  
(  !
)! "
{ 	
	CreateMap 
< 
Rol 
, 
VMRol  
>  !
(! "
)" #
.# $

ReverseMap$ .
(. /
)/ 0
;0 1
	CreateMap 
< 
Usuario 
, 
	VMUsuario (
>( )
() *
)* +
. 
	ForMember 
( 
destino "
=># %
destino 
. 
EsActivo $
,$ %
opt 
=> 
opt 
. 
MapFrom &
(& '
origen' -
=>. 0
origen1 7
.7 8
EsActivo8 @
==A C
trueD H
?I J
$numK L
:M N
$numO P
)P Q
) 
. 
	ForMember 
( 
destino "
=># %
destino 
. 
	NombreRol %
,% &
opt 
=> 
opt 
. 
MapFrom &
(& '
origen' -
=>. 0
origen1 7
.7 8
IdRolNavigation8 G
.G H
DescripcionH S
)S T
) 
; 
	CreateMap 
< 
	VMUsuario 
,  
Usuario! (
>( )
() *
)* +
. 
	ForMember 
( 
destino "
=># %
destino 
. 
EsActivo $
,$ %
opt 
=> 
opt 
. 
MapFrom &
(& '
origen' -
=>. 0
origen1 7
.7 8
EsActivo8 @
==A C
$numD E
?F G
trueH L
:M N
falseO T
)T U
)   
.!! 
	ForMember!! 
(!! 
destino!! "
=>!!# %
destino"" 
."" 
IdRolNavigation"" +
,""+ ,
opt## 
=>## 
opt## 
.## 
Ignore## %
(##% &
)##& '
)$$ 
;$$ 
	CreateMap)) 
<)) 
Negocio)) 
,)) 
	VMNegocio)) (
>))( )
())) *
)))* +
.** 
	ForMember** 
(** 
destino** "
=>**# %
destino++ 
.++ 
PorcentajeImpuesto++ .
,++. /
opt,, 
=>,, 
opt,, 
.,, 
MapFrom,, &
(,,& '
origen,,' -
=>,,. 0
Convert,,1 8
.,,8 9
ToString,,9 A
(,,A B
origen,,B H
.,,H I
PorcentajeImpuesto,,I [
.,,[ \
Value,,\ a
,,,a b
new,,c f
CultureInfo,,g r
(,,r s
$str,,s z
),,z {
),,{ |
),,| }
)-- 
;-- 
	CreateMap// 
<// 
	VMNegocio// 
,//  !
Negocio//" )
>//) *
(//* +
)//+ ,
.00 
	ForMember00 
(00 
destino00 !
=>00" $
destino11 
.11 
PorcentajeImpuesto11 -
,11- .
opt22 
=>22 
opt22 
.22 
MapFrom22 %
(22% &
origen22& ,
=>22- /
Convert220 7
.227 8
	ToDecimal228 A
(22A B
origen22B H
.22H I
PorcentajeImpuesto22I [
,22[ \
new22] `
CultureInfo22a l
(22l m
$str22m t
)22t u
)22u v
)22v w
)33 
;33 
	CreateMap99 
<99 
	Categoria99 
,99  
VMCategoria99! ,
>99, -
(99- .
)99. /
.:: 
	ForMember:: 
(:: 
destino:: 
=>::  
destino;; 
.;; 
esActivo;; 
,;;  
opt<< 
=><< 
opt<< 
.<< 
MapFrom<< !
(<<! "
origen<<" (
=><<) +
origen<<, 2
.<<2 3
EsActivo<<3 ;
==<<< >
true<<? C
?<<D E
$num<<F G
:<<H I
$num<<J K
)<<K L
)== 
;== 
	CreateMap?? 
<?? 
VMCategoria?? !
,??! "
	Categoria??# ,
>??, -
(??- .
)??. /
.@@ 
	ForMember@@ 
(@@ 
destino@@ 
=>@@ !
destinoAA 
.AA 
EsActivoAA  
,AA  !
optBB 
=>BB 
optBB 
.BB 
MapFromBB "
(BB" #
origenBB# )
=>BB* ,
origenBB- 3
.BB3 4
esActivoBB4 <
==BB= ?
$numBB@ A
?BBB C
trueBBD H
:BBI J
falseBBK P
)BBP Q
)CC 
;CC 
	CreateMapHH 
<HH 
ProductoHH 
,HH 

VMProductoHH  *
>HH* +
(HH+ ,
)HH, -
.II 
	ForMemberII 
(II 
destinoII "
=>II# %
destinoJJ 
.JJ 
EsActivoJJ $
,JJ$ %
optKK 
=>KK 
optKK 
.KK 
MapFromKK &
(KK& '
origenKK' -
=>KK. 0
origenKK1 7
.KK7 8
EsActivoKK8 @
==KKA C
trueKKD H
?KKI J
$numKKK L
:KKM N
$numKKO P
)KKP Q
)LL 
.MM 
	ForMemberMM 
(MM 
destinoMM "
=>MM# %
destinoNN 
.NN 
NombreCategoriaNN +
,NN+ ,
optOO 
=>OO 
optOO 
.OO 
MapFromOO &
(OO& '
origenOO' -
=>OO. 0
origenOO1 7
.OO7 8!
IdCategoriaNavigationOO8 M
.OOM N
DescripcionOON Y
)OOY Z
)PP 
.QQ 
	ForMemberQQ 
(QQ 
destinoQQ "
=>QQ# %
destinoRR 
.RR 
PrecioRR "
,RR" #
optSS 
=>SS 
optSS 
.SS 
MapFromSS &
(SS& '
origenSS' -
=>SS. 0
ConvertSS1 8
.SS8 9
ToStringSS9 A
(SSA B
origenSSB H
.SSH I
PrecioSSI O
.SSO P
ValueSSP U
,SSU V
newSSW Z
CultureInfoSS[ f
(SSf g
$strSSg n
)SSn o
)SSo p
)SSp q
)TT 
;TT 
	CreateMapVV 
<VV 

VMProductoVV  
,VV  !
ProductoVV" *
>VV+ ,
(VV, -
)VV- .
.WW 
	ForMemberWW 
(WW 
destinoWW "
=>WW# %
destinoXX 
.XX 
EsActivoXX $
,XX$ %
optYY 
=>YY 
optYY 
.YY 
MapFromYY &
(YY& '
origenYY' -
=>YY. 0
origenYY1 7
.YY7 8
EsActivoYY8 @
==YYA C
$numYYD E
?YYF G
trueYYH L
:YYM N
falseYYO T
)YYT U
)ZZ 
.[[ 
	ForMember[[ 
([[ 
destino[[ "
=>[[# %
destino\\ 
.\\ !
IdCategoriaNavigation\\ 1
,\\1 2
opt]] 
=>]] 
opt]] 
.]] 
Ignore]] %
(]]% &
)]]& '
)^^ 
.__ 
	ForMember__ 
(__ 
destino__ "
=>__# %
destino`` 
.`` 
Precio`` "
,``" #
optaa 
=>aa 
optaa 
.aa 
MapFromaa &
(aa& '
origenaa' -
=>aa. 0
Convertaa1 8
.aa8 9
	ToDecimalaa9 B
(aaB C
origenaaC I
.aaI J
PrecioaaJ P
,aaP Q
newaaR U
CultureInfoaaV a
(aaa b
$straab i
)aai j
)aaj k
)aak l
)bb 
;bb 
	CreateMapgg 
<gg 
TipoDocumentoVentagg (
,gg( ) 
VMTipoDocumentoVentagg* >
>gg> ?
(gg? @
)gg@ A
.ggA B

ReverseMapggB L
(ggL M
)ggM N
;ggN O
	CreateMapkk 
<kk 
Ventakk 
,kk 
VMVentakk #
>kk# $
(kk$ %
)kk% &
.ll 
	ForMemberll 
(ll 
destinoll #
=>ll$ &
destinomm 
.mm 
TipoDocumentoVentamm .
,mm. /
optnn 
=>nn 
optnn 
.nn 
MapFromnn &
(nn& '
origennn' -
=>nn. 0
origennn1 7
.nn7 8*
IdTipoDocumentoVentaNavigationnn8 V
.nnV W
DescripcionnnW b
)nnb c
)oo 
.pp 
	ForMemberpp 
(pp 
destinopp #
=>pp$ &
destinoqq 
.qq 
Usuarioqq #
,qq# $
optrr 
=>rr 
optrr 
.rr 
MapFromrr &
(rr& '
origenrr' -
=>rr. 0
origenrr1 7
.rr7 8
IdUsuarioNavigationrr8 K
.rrK L
NombrerrL R
)rrR S
)ss 
.tt 
	ForMembertt 
(tt 
destinott "
=>tt# %
destinouu 
.uu 
SubTotaluu $
,uu$ %
optvv 
=>vv 
optvv 
.vv 
MapFromvv &
(vv& '
origenvv' -
=>vv. 0
Convertvv1 8
.vv8 9
ToStringvv9 A
(vvA B
origenvvB H
.vvH I
SubTotalvvI Q
.vvQ R
ValuevvR W
,vvW X
newvvY \
CultureInfovv] h
(vvh i
$strvvi p
)vvp q
)vvq r
)vvr s
)ww 
.xx 
	ForMemberxx 
(xx 
destinoxx "
=>xx# %
destinoyy 
.yy 
ImpuestoTotalyy )
,yy) *
optzz 
=>zz 
optzz 
.zz 
MapFromzz &
(zz& '
origenzz' -
=>zz. 0
Convertzz1 8
.zz8 9
ToStringzz9 A
(zzA B
origenzzB H
.zzH I
ImpuestoTotalzzI V
.zzV W
ValuezzW \
,zz\ ]
newzz^ a
CultureInfozzb m
(zzm n
$strzzn u
)zzu v
)zzv w
)zzw x
){{ 
.|| 
	ForMember|| 
(|| 
destino|| #
=>||$ &
destino}} 
.}} 
Total}} !
,}}! "
opt~~ 
=>~~ 
opt~~ 
.~~ 
MapFrom~~ &
(~~& '
origen~~' -
=>~~. 0
Convert~~1 8
.~~8 9
ToString~~9 A
(~~A B
origen~~B H
.~~H I
Total~~I N
.~~N O
Value~~O T
,~~T U
new~~V Y
CultureInfo~~Z e
(~~e f
$str~~f m
)~~m n
)~~n o
)~~o p
) 
.
ÄÄ 
	ForMember
ÄÄ 
(
ÄÄ 
destino
ÄÄ #
=>
ÄÄ$ &
destino
ÅÅ 
.
ÅÅ 
FechaRegistro
ÅÅ )
,
ÅÅ) *
opt
ÇÇ 
=>
ÇÇ 
opt
ÇÇ 
.
ÇÇ 
MapFrom
ÇÇ &
(
ÇÇ& '
origen
ÇÇ' -
=>
ÇÇ. 0
origen
ÇÇ1 7
.
ÇÇ7 8
FechaRegistro
ÇÇ8 E
.
ÇÇE F
Value
ÇÇF K
.
ÇÇK L
ToString
ÇÇL T
(
ÇÇT U
$str
ÇÇU a
)
ÇÇa b
)
ÇÇb c
)
ÉÉ 
;
ÉÉ 
	CreateMap
ÖÖ 
<
ÖÖ 
VMVenta
ÖÖ 
,
ÖÖ 
Venta
ÖÖ $
>
ÖÖ$ %
(
ÖÖ% &
)
ÖÖ& '
.
ÜÜ 
	ForMember
ÜÜ 
(
ÜÜ 
destino
ÜÜ  
=>
ÜÜ! #
destino
áá 
.
áá 
SubTotal
áá #
,
áá# $
opt
àà 
=>
àà 
opt
àà 
.
àà 
MapFrom
àà %
(
àà% &
origen
àà& ,
=>
àà- /
Convert
àà0 7
.
àà7 8
	ToDecimal
àà8 A
(
ààA B
origen
ààB H
.
ààH I
SubTotal
ààI Q
,
ààQ R
new
ààS V
CultureInfo
ààW b
(
ààb c
$str
ààc j
)
ààj k
)
ààk l
)
ààl m
)
ââ 
.
ää 
	ForMember
ää 
(
ää 
destino
ää !
=>
ää" $
destino
ãã 
.
ãã 
ImpuestoTotal
ãã (
,
ãã( )
opt
åå 
=>
åå 
opt
åå 
.
åå 
MapFrom
åå %
(
åå% &
origen
åå& ,
=>
åå- /
Convert
åå0 7
.
åå7 8
	ToDecimal
åå8 A
(
ååA B
origen
ååB H
.
ååH I
ImpuestoTotal
ååI V
,
ååV W
new
ååX [
CultureInfo
åå\ g
(
ååg h
$str
ååh o
)
ååo p
)
ååp q
)
ååq r
)
çç 
.
éé 
	ForMember
éé 
(
éé 
destino
éé "
=>
éé# %
destino
èè 
.
èè 
Total
èè  
,
èè  !
opt
êê 
=>
êê 
opt
êê 
.
êê 
MapFrom
êê %
(
êê% &
origen
êê& ,
=>
êê- /
Convert
êê0 7
.
êê7 8
	ToDecimal
êê8 A
(
êêA B
origen
êêB H
.
êêH I
Total
êêI N
,
êêN O
new
êêP S
CultureInfo
êêT _
(
êê_ `
$str
êê` g
)
êêg h
)
êêh i
)
êêi j
)
ëë 
;
ëë 
	CreateMap
ïï 
<
ïï 
DetalleVenta
ïï "
,
ïï" #
VMDetalleVenta
ïï$ 2
>
ïï2 3
(
ïï3 4
)
ïï4 5
.
ññ 
	ForMember
ññ 
(
ññ 
destino
ññ #
=>
ññ$ &
destino
óó 
.
óó 
Precio
óó "
,
óó" #
opt
òò 
=>
òò 
opt
òò 
.
òò 
MapFrom
òò &
(
òò& '
origen
òò' -
=>
òò. 0
Convert
òò1 8
.
òò8 9
ToString
òò9 A
(
òòA B
origen
òòB H
.
òòH I
Precio
òòI O
.
òòO P
Value
òòP U
,
òòU V
new
òòW Z
CultureInfo
òò[ f
(
òòf g
$str
òòg n
)
òòn o
)
òòo p
)
òòp q
)
ôô 
.
öö 
	ForMember
öö 
(
öö 
destino
öö #
=>
öö$ &
destino
õõ 
.
õõ 
Total
õõ !
,
õõ! "
opt
úú 
=>
úú 
opt
úú 
.
úú 
MapFrom
úú &
(
úú& '
origen
úú' -
=>
úú. 0
Convert
úú1 8
.
úú8 9
ToString
úú9 A
(
úúA B
origen
úúB H
.
úúH I
Total
úúI N
.
úúN O
Value
úúO T
,
úúT U
new
úúV Y
CultureInfo
úúZ e
(
úúe f
$str
úúf m
)
úúm n
)
úún o
)
úúo p
)
ùù 
;
ùù 
	CreateMap
üü 
<
üü 
VMDetalleVenta
üü %
,
üü% &
DetalleVenta
üü& 2
>
üü2 3
(
üü3 4
)
üü4 5
.
†† 
	ForMember
†† 
(
†† 
destino
†† !
=>
††" $
destino
°° 
.
°° 
Precio
°°  
,
°°  !
opt
¢¢ 
=>
¢¢ 
opt
¢¢ 
.
¢¢ 
MapFrom
¢¢ $
(
¢¢$ %
origen
¢¢% +
=>
¢¢, .
Convert
¢¢/ 6
.
¢¢6 7
	ToDecimal
¢¢7 @
(
¢¢@ A
origen
¢¢A G
.
¢¢G H
Precio
¢¢H N
,
¢¢N O
new
¢¢P S
CultureInfo
¢¢T _
(
¢¢_ `
$str
¢¢` g
)
¢¢g h
)
¢¢h i
)
¢¢i j
)
££ 
.
§§ 
	ForMember
§§ 
(
§§ 
destino
§§ !
=>
§§" $
destino
•• 
.
•• 
Total
•• 
,
••  
opt
¶¶ 
=>
¶¶ 
opt
¶¶ 
.
¶¶ 
MapFrom
¶¶ $
(
¶¶$ %
origen
¶¶% +
=>
¶¶, .
Convert
¶¶/ 6
.
¶¶6 7
	ToDecimal
¶¶7 @
(
¶¶@ A
origen
¶¶A G
.
¶¶G H
Total
¶¶H M
,
¶¶M N
new
¶¶O R
CultureInfo
¶¶S ^
(
¶¶^ _
$str
¶¶_ f
)
¶¶f g
)
¶¶g h
)
¶¶h i
)
ßß 
;
ßß 
	CreateMap
©© 
<
©© 
DetalleVenta
©© "
,
©©" #
VMReporteVenta
©©# 1
>
©©1 2
(
©©2 3
)
©©3 4
.
™™ 
	ForMember
™™ 
(
™™ 
destino
™™ 
=>
™™ !
destino
´´ 
.
´´ 
FechaRegistro
´´ '
,
´´' (
opt
¨¨ 
=>
¨¨ 
opt
¨¨ 
.
¨¨ 
MapFrom
¨¨ $
(
¨¨$ %
origen
¨¨% +
=>
¨¨, .
origen
¨¨/ 5
.
¨¨5 6
IdVentaNavigation
¨¨6 G
.
¨¨G H
FechaRegistro
¨¨H U
.
¨¨U V
Value
¨¨V [
.
¨¨[ \
ToString
¨¨\ d
(
¨¨d e
$str
¨¨e q
)
¨¨q r
)
¨¨r s
)
≠≠ 
.
ÆÆ 
	ForMember
ÆÆ 
(
ÆÆ 
destino
ÆÆ 
=>
ÆÆ !
destino
ØØ 
.
ØØ 
NumeroVenta
ØØ %
,
ØØ% &
opt
∞∞ 
=>
∞∞ 
opt
∞∞ 
.
∞∞ 
MapFrom
∞∞ $
(
∞∞$ %
origen
∞∞% +
=>
∞∞, .
origen
∞∞/ 5
.
∞∞5 6
IdVentaNavigation
∞∞6 G
.
∞∞G H
NumeroVenta
∞∞H S
)
∞∞T U
)
±± 
.
≤≤ 
	ForMember
≤≤ 
(
≤≤ 
destino
≤≤ 
=>
≤≤ !
destino
≥≥ 
.
≥≥ 
TipoDocumento
≥≥ '
,
≥≥' (
opt
¥¥ 
=>
¥¥ 
opt
¥¥ 
.
¥¥ 
MapFrom
¥¥ $
(
¥¥$ %
origen
¥¥% +
=>
¥¥, .
origen
¥¥/ 5
.
¥¥5 6
IdVentaNavigation
¥¥6 G
.
¥¥G H,
IdTipoDocumentoVentaNavigation
¥¥H f
.
¥¥f g
Descripcion
¥¥g r
)
¥¥r s
)
µµ 
.
∂∂ 
	ForMember
∂∂ 
(
∂∂ 
destino
∂∂ 
=>
∂∂ !
destino
∑∑ 
.
∑∑ 
DocumentoCliente
∑∑ *
,
∑∑* +
opt
∏∏ 
=>
∏∏ 
opt
∏∏ 
.
∏∏ 
MapFrom
∏∏ $
(
∏∏$ %
origen
∏∏% +
=>
∏∏, .
origen
∏∏/ 5
.
∏∏5 6
IdVentaNavigation
∏∏6 G
.
∏∏G H
DocumentoCliente
∏∏H X
)
∏∏X Y
)
ππ 
.
∫∫ 
	ForMember
∫∫ 
(
∫∫ 
destino
∫∫ 
=>
∫∫  "
destino
ªª 
.
ªª 
NombreCliente
ªª '
,
ªª' (
opt
ºº 
=>
ºº 
opt
ºº 
.
ºº 
MapFrom
ºº $
(
ºº$ %
origen
ºº% +
=>
ºº, .
origen
ºº/ 5
.
ºº5 6
IdVentaNavigation
ºº6 G
.
ººG H
NombreCliente
ººH U
)
ººU V
)
ΩΩ 
.
øø 
	ForMember
øø 
(
øø 
destino
øø  
=>
øø! #
destino
¿¿ 
.
¿¿ 
SubTotalVenta
¿¿ '
,
¿¿' (
opt
¡¡ 
=>
¡¡ 
opt
¡¡ 
.
¡¡ 
MapFrom
¡¡ $
(
¡¡$ %
origen
¡¡% +
=>
¡¡, .
Convert
¡¡/ 6
.
¡¡6 7
ToString
¡¡7 ?
(
¡¡? @
origen
¡¡@ F
.
¡¡F G
IdVentaNavigation
¡¡G X
.
¡¡X Y
SubTotal
¡¡Y a
.
¡¡a b
Value
¡¡b g
,
¡¡g h
new
¡¡i l
CultureInfo
¡¡m x
(
¡¡x y
$str¡¡y Ä
)¡¡Ä Å
)¡¡Å Ç
)¡¡Ç É
)
¬¬ 
.
√√ 
	ForMember
√√ 
(
√√ 
destino
√√  
=>
√√! #
destino
ƒƒ 
.
ƒƒ  
ImpuestoTotalVenta
ƒƒ ,
,
ƒƒ, -
opt
≈≈ 
=>
≈≈ 
opt
≈≈ 
.
≈≈ 
MapFrom
≈≈ $
(
≈≈$ %
origen
≈≈% +
=>
≈≈, .
Convert
≈≈/ 6
.
≈≈6 7
ToString
≈≈7 ?
(
≈≈? @
origen
≈≈@ F
.
≈≈F G
IdVentaNavigation
≈≈G X
.
≈≈X Y
ImpuestoTotal
≈≈Y f
.
≈≈f g
Value
≈≈g l
,
≈≈l m
new
≈≈n q
CultureInfo
≈≈r }
(
≈≈} ~
$str≈≈~ Ö
)≈≈Ö Ü
)≈≈Ü á
)≈≈á à
)
∆∆ 
.
«« 
	ForMember
«« 
(
«« 
destino
«« !
=>
««" $
destino
»» 
.
»» 

TotalVenta
»» $
,
»»$ %
opt
…… 
=>
…… 
opt
…… 
.
…… 
MapFrom
…… $
(
……$ %
origen
……% +
=>
……, .
Convert
……/ 6
.
……6 7
ToString
……7 ?
(
……? @
origen
……@ F
.
……F G
IdVentaNavigation
……G X
.
……X Y
Total
……Y ^
.
……^ _
Value
……_ d
,
……d e
new
……f i
CultureInfo
……j u
(
……u v
$str
……v }
)
……} ~
)
……~ 
)…… Ä
)
   
.
ÀÀ 
	ForMember
ÀÀ 
(
ÀÀ 
destino
ÀÀ !
=>
ÀÀ" $
destino
ÃÃ 
.
ÃÃ 
Producto
ÃÃ "
,
ÃÃ" #
opt
ÕÕ 
=>
ÕÕ 
opt
ÕÕ 
.
ÕÕ 
MapFrom
ÕÕ $
(
ÕÕ$ %
origen
ÕÕ% +
=>
ÕÕ, .
origen
ÕÕ/ 5
.
ÕÕ5 6!
DescripcionProducto
ÕÕ6 I
)
ÕÕI J
)
ŒŒ 
.
œœ 
	ForMember
œœ 
(
œœ 
destino
œœ !
=>
œœ" $
destino
–– 
.
–– 
Precio
––  
,
––  !
opt
—— 
=>
—— 
opt
—— 
.
—— 
MapFrom
—— $
(
——$ %
origen
——% +
=>
——, .
Convert
——/ 6
.
——6 7
ToString
——7 ?
(
——? @
origen
——@ F
.
——F G
Precio
——G M
.
——M N
Value
——N S
,
——S T
new
——U X
CultureInfo
——Y d
(
——d e
$str
——e l
)
——l m
)
——m n
)
——n o
)
““ 
.
”” 
	ForMember
”” 
(
”” 
destino
”” "
=>
””# %
destino
‘‘ 
.
‘‘ 
Total
‘‘ 
,
‘‘  
opt
’’ 
=>
’’ 
opt
’’ 
.
’’ 
MapFrom
’’ $
(
’’$ %
origen
’’% +
=>
’’, .
Convert
’’/ 6
.
’’6 7
ToString
’’7 ?
(
’’? @
origen
’’@ F
.
’’F G
Total
’’G L
.
’’L M
Value
’’M R
,
’’R S
new
’’T W
CultureInfo
’’X c
(
’’c d
$str
’’d k
)
’’k l
)
’’l m
)
’’m n
)
÷÷ 
;
◊◊ 
	CreateMap
‹‹ 
<
‹‹ 
Menu
‹‹ 
,
‹‹ 
VMMenu
‹‹ "
>
‹‹" #
(
‹‹# $
)
‹‹$ %
.
›› 
	ForMember
›› 
(
›› 
destino
›› #
=>
››$ &
destino
ﬁﬁ 
.
ﬁﬁ 
SubMenus
ﬁﬁ "
,
ﬁﬁ" #
opt
ﬂﬂ 
=>
ﬂﬂ 
opt
ﬂﬂ 
.
ﬂﬂ 
MapFrom
ﬂﬂ $
(
ﬂﬂ$ %
origen
ﬂﬂ% +
=>
ﬂﬂ, .
origen
ﬂﬂ/ 5
.
ﬂﬂ5 6*
InverseIdMenuPadreNavigation
ﬂﬂ6 R
)
ﬂﬂR S
)
‡‡ 
;
‡‡ 
}
„„ 	
}
ÂÂ 
}ÊÊ ú
FD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddAuthentication "
(" #(
CookieAuthenticationDefaults# ?
.? @ 
AuthenticationScheme@ T
)T U
. 
	AddCookie 
( 
option 
=> 
{ 
option 
. 
	LoginPath 
= 
$str *
;* +
option 
. 
ExpireTimeSpan 
= 
TimeSpan  (
.( )
FromMinutes) 4
(4 5
$num5 7
)7 8
;8 9
} 
) 
; 
builder 
. 
Services 
. 
InyectarDependencia $
($ %
builder% ,
., -
Configuration- :
): ;
;; <
builder 
. 
Services 
. 
AddAutoMapper 
( 
typeof %
(% &
AutoMapperProfile& 7
)7 8
)8 9
;9 :
var 
context 
= 
new %
CustomAssemblyLoadContext +
(+ ,
), -
;- .
context 
.  
LoadUnmanagedLibrary 
( 
Path !
.! "
Combine" )
() *
	Directory* 3
.3 4
GetCurrentDirectory4 G
(G H
)H I
,I J
$strK t
)t u
)u v
;v w
builder 
. 
Services 
. 
AddSingleton 
( 
typeof $
($ %

IConverter% /
)/ 0
,0 1
new2 5!
SynchronizedConverter6 K
(K L
newL O
PdfToolsP X
(X Y
)Y Z
)Z [
)[ \
;\ ]
var!! 
app!! 
=!! 	
builder!!
 
.!! 
Build!! 
(!! 
)!! 
;!! 
if$$ 
($$ 
!$$ 
app$$ 
.$$ 	
Environment$$	 
.$$ 
IsDevelopment$$ "
($$" #
)$$# $
)$$$ %
{%% 
app&& 
.&& 
UseExceptionHandler&& 
(&& 
$str&& )
)&&) *
;&&* +
}'' 
app(( 
.(( 
UseStaticFiles(( 
((( 
)(( 
;(( 
app** 
.** 

UseRouting** 
(** 
)** 
;** 
app,, 
.,, 
UseAuthentication,, 
(,, 
),, 
;,, 
app.. 
... 
UseAuthorization.. 
(.. 
).. 
;.. 
app00 
.00 
MapControllerRoute00 
(00 
name11 
:11 	
$str11
 
,11 
pattern22 
:22 
$str22 7
)227 8
;228 9
app44 
.44 
Run44 
(44 
)44 	
;44	 
Ω
_D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMVentasSemana.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMVentasSemana 
{ 
public 
string 
? 
Fecha 
{ 
get "
;" #
set$ '
;' (
}) *
public 
int 
Total 
{ 
get 
; 
set  #
;# $
}% &
} 
}		 ˝
XD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMVenta.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMVenta 
{ 
public 
int 
IdVenta 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
NumeroVenta "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
?  
IdTipoDocumentoVenta (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
string 
? 
TipoDocumentoVenta )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public		 
int		 
?		 
	IdUsuario		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
string

 
?

 
Usuario

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
? 
DocumentoCliente '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
? 
NombreCliente $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
SubTotal 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
ImpuestoTotal $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
Total 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
FechaRegistro $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
virtual 
ICollection "
<" #
VMDetalleVenta# 1
>1 2
DetalleVenta3 ?
{@ A
getB E
;E F
setG J
;J K
}L M
} 
} 
_D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMUsuarioLogin.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMUsuarioLogin 
{ 
public 
string 
? 
Correo 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Clave 
{ 
get "
;" #
set$ '
;' (
}) *
public 
bool 
MantenerSesion "
{# $
get% (
;( )
set* -
;- .
}/ 0
}		 
}

 Ø
ZD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMUsuario.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
	VMUsuario 
{ 
public 
int 
	IdUsuario 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Nombre 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Correo 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Telefono 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
int		 
?		 
IdRol		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
public

 
string

 
?

 
	NombreRol

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
string 
? 
UrlFoto 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
int 
? 
EsActivo 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ﬁ
eD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMTipoDocumentoVenta.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class  
VMTipoDocumentoVenta %
{ 
public 
int  
IdTipoDocumentoVenta '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
string 
? 
Descripcion "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ±
VD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMRol.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMRol 
{ 
public 
int 
IdRol 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
? 
Descripcion "
{# $
get% (
;( )
set* -
;- .
}/ 0
} 
} ó
_D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMReporteVenta.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMReporteVenta 
{ 
public 
string 
? 
FechaRegistro $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
NumeroVenta "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
TipoDocumento $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
DocumentoCliente '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public		 
string		 
?		 
NombreCliente		 $
{		% &
get		' *
;		* +
set		, /
;		/ 0
}		1 2
public

 
string

 
?

 
SubTotalVenta

 $
{

% &
get

' *
;

* +
set

, /
;

/ 0
}

1 2
public 
string 
? 
ImpuestoTotalVenta )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
? 

TotalVenta !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
? 
Producto 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Precio 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Total 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} …
bD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMProductosSemana.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMProductosSemana "
{ 
public 
string 
? 
Producto 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
Cantidad 
{ 
get !
;! "
set# &
;& '
}( )
} 
}		 ï
[D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMProducto.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 

VMProducto 
{ 
public 
int 

IdProducto 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
CodigoBarra "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Marca 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Descripcion "
{# $
get% (
;( )
set* -
;- .
}/ 0
public		 
int		 
?		 
IdCategoria		 
{		  !
get		" %
;		% &
set		' *
;		* +
}		, -
public

 
string

 
?

 
NombreCategoria

 &
{

' (
get

) ,
;

, -
set

. 1
;

1 2
}

3 4
public 
int 
? 
Stock 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
? 
	UrlImagen  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
? 
Precio 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
? 
EsActivo 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} Õ
[D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMPDFVenta.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 

VMPDFVenta 
{ 
public 
	VMNegocio 
? 
negocio !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
VMVenta 
? 
venta 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ˘
ZD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMNegocio.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
	VMNegocio 
{ 
public 
int 
	IdNegocio 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
UrlLogo 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
NumeroDocumento &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
? 
Nombre 
{ 
get  #
;# $
set% (
;( )
}* +
public		 
string		 
?		 
Correo		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
string

 
?

 
	Direccion

  
{

! "
get

# &
;

& '
set

( +
;

+ ,
}

- .
public 
string 
? 
Telefono 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
? 
PorcentajeImpuesto )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
string 
? 
SimboloMoneda $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ä

WD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMMenu.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMMenu 
{ 
public 
string 
? 
Descripcion "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Icono 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
? 
Controlador "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
PaginaAccion #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public

 
virtual

 
ICollection

 "
<

" #
VMMenu

# )
>

) *
SubMenus

+ 3
{

4 5
get

6 9
;

9 :
set

; >
;

> ?
}

@ A
} 
} º
_D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMDetalleVenta.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMDetalleVenta 
{ 
public 
int 
? 

IdProducto 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
MarcaProducto $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
string 
? 
DescripcionProducto *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 
string 
? 
CategoriaProducto (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public		 
int		 
?		 
Cantidad		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
string

 
?

 
Precio

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
public 
string 
? 
Total 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} …
\D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMDashBoard.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMDashBoard 
{ 
public 
int 
TotalVentas 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
TotalIngresos $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
int 
TotalProductos !
{" #
get$ '
;' (
set) ,
;, -
}. /
public		 
int		 
TotalCategorias		 "
{		# $
get		% (
;		( )
set		* -
;		- .
}		/ 0
public 
List 
< 
VMVentasSemana "
>" #
VentasUltimaSemana$ 6
{7 8
get9 <
;< =
set> A
;A B
}C D
public 
List 
< 
VMProductosSemana %
>% &$
ProductosTopUltimaSemana' ?
{@ A
getB E
;E F
setG J
;J K
}L M
} 
} ‹
\D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMCategoria.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMCategoria 
{ 
public 
int 
IdCategoria 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
? 
Descripcion "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
int 
esActivo 
{ 
get !
;! "
set# &
;& '
}( )
} 
}		 ⁄
_D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ViewModels\VMCambiarClave.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
.+ ,

ViewModels, 6
{ 
public 

class 
VMCambiarClave 
{ 
public 
string 
? 
claveActual "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 

claveNueva !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} €
TD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Models\ErrorViewModel.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Models% +
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 éL
ZD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\VentaController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
[ 
	Authorize 
] 
public 

class 
VentaController  
:! "

Controller# -
{ 
private 
readonly &
ITipoDocumentoVentaService 3'
_tipoDocumentoVentaServicio4 O
;O P
private 
readonly 
IVentaService &
_ventaServicio' 5
;5 6
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 

IConverter #

_converter$ .
;. /
public 
VentaController 
( &
ITipoDocumentoVentaService 9&
tipoDocumentoVentaServicio: T
,T U
IVentaService 
ventaServicio '
,' (
IMapper 
mapper 
, 

IConverter 
	converter !
) 
{ 	'
_tipoDocumentoVentaServicio '
=( )&
tipoDocumentoVentaServicio* D
;D E
_ventaServicio 
= 
ventaServicio *
;* +
_mapper   
=   
mapper   
;   

_converter!! 
=!! 
	converter!! "
;!!" #
}"" 	
public$$ 
IActionResult$$ 

NuevaVenta$$ '
($$' (
)$$( )
{%% 	
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
public)) 
IActionResult)) 
HistorialVenta)) +
())+ ,
))), -
{** 	
return++ 
View++ 
(++ 
)++ 
;++ 
},, 	
[.. 	
HttpGet..	 
].. 
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (#
ListaTipoDocumentoVenta//) @
(//@ A
)//A B
{00 	
List22 
<22  
VMTipoDocumentoVenta22 %
>22% &!
vmListaTipoDocumentos22' <
=22= >
_mapper22? F
.22F G
Map22G J
<22J K
List22K O
<22O P 
VMTipoDocumentoVenta22P d
>22d e
>22e f
(22f g
await22g l(
_tipoDocumentoVentaServicio	22m à
.
22à â
Lista
22â é
(
22é è
)
22è ê
)
22ê ë
;
22ë í
return44 

StatusCode44 
(44 
StatusCodes44 )
.44) *
Status200OK44* 5
,445 6!
vmListaTipoDocumentos447 L
)44L M
;44M N
}55 	
[77 	
HttpGet77	 
]77 
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
ObtenerProductos88) 9
(889 :
string88: @
busqueda88A I
)88I J
{99 	
List:: 
<:: 

VMProducto:: 
>:: 
vmListaProductos:: -
=::. /
_mapper::0 7
.::7 8
Map::8 ;
<::; <
List::< @
<::@ A

VMProducto::A K
>::K L
>::L M
(::M N
await::N S
_ventaServicio::T b
.::b c
ObtenerProductos::c s
(::s t
busqueda::t |
)::| }
)::} ~
;::~ 
return<< 

StatusCode<< 
(<< 
StatusCodes<< )
.<<) *
Status200OK<<* 5
,<<5 6
vmListaProductos<<7 G
)<<G H
;<<H I
}== 	
[AA 	
HttpPostAA	 
]AA 
publicBB 
asyncBB 
TaskBB 
<BB 
IActionResultBB '
>BB' (
RegistrarVentaBB) 7
(BB7 8
[BB8 9
FromBodyBB9 A
]BBA B
VMVentaBBC J
modeloBBK Q
)BBQ R
{CC 	
GenericResponseEE 
<EE 
VMVentaEE #
>EE# $
	gResponseEE% .
=EE/ 0
newEE1 4
GenericResponseEE5 D
<EED E
VMVentaEEE L
>EEL M
(EEM N
)EEN O
;EEO P
tryGG 
{HH 
ClaimsPrincipalII 
	claimUserII  )
=II* +
HttpContextII, 7
.II7 8
UserII8 <
;II< =
stringKK 
	idUsuarioKK  
=KK! "
	claimUserKK# ,
.KK, -
ClaimsKK- 3
.LL 
WhereLL 
(LL 
cLL 
=>LL 
cLL  !
.LL! "
TypeLL" &
==LL' )

ClaimTypesLL* 4
.LL4 5
NameIdentifierLL5 C
)LLC D
.MM 
SelectMM 
(MM 
cMM 
=>MM  
cMM! "
.MM" #
ValueMM# (
)MM( )
.MM) *
SingleOrDefaultMM* 9
(MM9 :
)MM: ;
;MM; <
modeloOO 
.OO 
	IdUsuarioOO  
=OO! "
intOO# &
.OO& '
ParseOO' ,
(OO, -
	idUsuarioOO- 6
)OO6 7
;OO7 8
VentaQQ 
venta_creadaQQ "
=QQ# $
awaitQQ% *
_ventaServicioQQ+ 9
.QQ9 :
	RegistrarQQ: C
(QQC D
_mapperQQD K
.QQK L
MapQQL O
<QQO P
VentaQQP U
>QQU V
(QQV W
modeloQQW ]
)QQ] ^
)QQ^ _
;QQ_ `
modeloRR 
=RR 
_mapperRR  
.RR  !
MapRR! $
<RR$ %
VMVentaRR% ,
>RR, -
(RR- .
venta_creadaRR. :
)RR: ;
;RR; <
	gResponseTT 
.TT 
EstadoTT  
=TT! "
trueTT# '
;TT' (
	gResponseUU 
.UU 
ObjetoUU  
=UU! "
modeloUU# )
;UU) *
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX 
{XX  !
	gResponseZZ 
.ZZ 
EstadoZZ  
=ZZ! "
falseZZ# (
;ZZ( )
	gResponse[[ 
.[[ 
Mensaje[[ !
=[[" #
ex[[$ &
.[[& '
Message[[' .
;[[. /
}\\ 
return^^ 

StatusCode^^ 
(^^ 
StatusCodes^^ )
.^^) *
Status200OK^^* 5
,^^5 6
	gResponse^^7 @
)^^@ A
;^^A B
}__ 	
[cc 	
HttpGetcc	 
]cc 
publicdd 
asyncdd 
Taskdd 
<dd 
IActionResultdd '
>dd' (
	Historialdd) 2
(dd2 3
stringdd3 9
numeroVentadd: E
,ddE F
stringddF L
fechaInicioddM X
,ddX Y
stringddZ `
fechaFindda i
)ddi j
{ee 	
Listgg 
<gg 
VMVentagg 
>gg 
vmHistorialVentagg *
=gg+ ,
_mappergg- 4
.gg4 5
Mapgg5 8
<gg8 9
Listgg9 =
<gg= >
VMVentagg> E
>ggE F
>ggF G
(ggG H
awaitggH M
_ventaServicioggN \
.gg\ ]
	Historialgg] f
(ggf g
numeroVentaggg r
,ggr s
fechaInicioggt 
,	gg Ä
fechaFin
ggÅ â
)
ggâ ä
)
ggä ã
;
ggã å
returnii 

StatusCodeii 
(ii 
StatusCodesii )
.ii) *
Status200OKii* 5
,ii5 6
vmHistorialVentaii7 G
)iiG H
;iiH I
}jj 	
publicmm 
IActionResultmm 
MostrarPDFVentamm ,
(mm, -
stringmm- 3
numeroVentamm4 ?
)mm? @
{mmA B
stringoo 
urlPlantillaVistaoo $
=oo% &
$"oo' )
{oo) *
thisoo* .
.oo. /
Requestoo/ 6
.oo6 7
Schemeoo7 =
}oo= >
$stroo> A
{ooA B
thisooB F
.ooF G
RequestooG N
.ooN O
HostooO S
}ooS T
$strooT t
{oot u
numeroVenta	oou Ä
}
ooÄ Å
"
ooÅ Ç
;
ooÇ É
varqq 
pdfqq 
=qq 
newqq 
HtmlToPdfDocumentqq +
(qq+ ,
)qq, -
{rr 
GlobalSettingsss 
=ss  
newss! $
GlobalSettingsss% 3
(ss3 4
)ss4 5
{ss6 7
	PaperSizett 
=tt 
	PaperKindtt  )
.tt) *
A4tt* ,
,tt, -
Orientationuu 
=uu  !
Orientationuu" -
.uu- .
Portraituu. 6
,uu6 7
}vv 
,vv 
Objectsww 
=ww 
{ww 
newxx 
ObjectSettingsxx &
(xx& '
)xx' (
{xx( )
Pageyy 
=yy 
urlPlantillaVistayy 0
}zz 
}{{ 
}|| 
;|| 
var~~ 

archivoPDF~~ 
=~~ 

_converter~~ '
.~~' (
Convert~~( /
(~~/ 0
pdf~~0 3
)~~3 4
;~~4 5
return
ÄÄ 
File
ÄÄ 
(
ÄÄ 

archivoPDF
ÄÄ "
,
ÄÄ" #
$str
ÄÄ$ 5
)
ÄÄ5 6
;
ÄÄ6 7
}
ÇÇ 	
}
ÑÑ 
}ÖÖ ∫`
\D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\UsuarioController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
[ 
	Authorize 
] 
public 

class 
UsuarioController "
:# $

Controller% /
{ 
private 
readonly 
IUsuarioService (
_usuarioServicio) 9
;9 :
private 
readonly 
IRolService $
_rolServicio% 1
;1 2
private 
readonly 
IMapper  
_mapper! (
;( )
public 
UsuarioController  
(  !
IUsuarioService! 0
usuarioServicio1 @
,@ A
IRolService 
rolServicio #
,# $
IMapper 
mapper 
) 
{ 	
_usuarioServicio 
= 
usuarioServicio .
;. /
_rolServicio 
= 
rolServicio &
;& '
_mapper 
= 
mapper 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{   	
return!! 
View!! 
(!! 
)!! 
;!! 
}"" 	
[$$ 	
HttpGet$$	 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (

ListaRoles%%) 3
(%%3 4
)%%4 5
{%%6 7
List&& 
<&& 
VMRol&& 
>&& 
vmListaRoles&& $
=&&% &
_mapper&&' .
.&&. /
Map&&/ 2
<&&2 3
List&&3 7
<&&7 8
VMRol&&8 =
>&&= >
>&&> ?
(&&? @
await&&@ E
_rolServicio&&F R
.&&R S
Lista&&S X
(&&X Y
)&&Y Z
)&&Z [
;&&[ \
return'' 

StatusCode'' 
('' 
StatusCodes'' )
.'') *
Status200OK''* 5
,''5 6
vmListaRoles''7 C
)''C D
;''D E
}(( 	
[** 	
HttpGet**	 
]** 
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (
Lista++) .
(++. /
)++/ 0
{,, 	
List-- 
<-- 
	VMUsuario-- 
>-- 
vmUsuarioLista-- *
=--+ ,
_mapper--- 4
.--4 5
Map--5 8
<--8 9
List--9 =
<--= >
	VMUsuario--> G
>--G H
>--H I
(--I J
await--J O
_usuarioServicio--P `
.--` a
Lista--a f
(--f g
)--g h
)--h i
;--i j
return.. 

StatusCode.. 
(.. 
StatusCodes.. )
...) *
Status200OK..* 5
,..5 6
new..7 :
{..; <
data..= A
=..B C
vmUsuarioLista..D R
}..S T
)..T U
;..U V
}// 	
[11 	
HttpPost11	 
]11 
public22 
async22 
Task22 
<22 
IActionResult22 '
>22' (
Crear22) .
(22. /
[22/ 0
FromForm220 8
]228 9
	IFormFile22: C
foto22D H
,22H I
[22I J
FromForm22J R
]22R S
string22T Z
modelo22[ a
)22a b
{22c d
GenericResponse44 
<44 
	VMUsuario44 %
>44% &
	gResponse44' 0
=441 2
new443 6
GenericResponse447 F
<44F G
	VMUsuario44G P
>44P Q
(44Q R
)44R S
;44S T
try66 
{77 
	VMUsuario88 
	vmUsuario88 #
=88$ %
JsonConvert88& 1
.881 2
DeserializeObject882 C
<88C D
	VMUsuario88D M
>88M N
(88N O
modelo88O U
)88U V
;88V W
string:: 

nombreFoto:: !
=::" #
$str::$ &
;::& '
Stream;; 

fotoStream;; !
=;;" #
null;;$ (
;;;( )
if== 
(== 
foto== 
!=== 
null==  
)==  !
{==" #
string>> 
nombre_en_codigo>> +
=>>, -
Guid>>. 2
.>>2 3
NewGuid>>3 :
(>>: ;
)>>; <
.>>< =
ToString>>= E
(>>E F
$str>>F I
)>>I J
;>>J K
string?? 
	extension?? $
=??% &
Path??' +
.??+ ,
GetExtension??, 8
(??8 9
foto??9 =
.??= >
FileName??> F
)??F G
;??G H

nombreFoto@@ 
=@@  
string@@! '
.@@' (
Concat@@( .
(@@. /
nombre_en_codigo@@/ ?
,@@? @
	extension@@A J
)@@J K
;@@K L

fotoStreamAA 
=AA  
fotoAA! %
.AA% &
OpenReadStreamAA& 4
(AA4 5
)AA5 6
;AA6 7
}BB 
stringDD 
urlPlantillaCorreoDD )
=DD* +
$"DD, .
{DD. /
thisDD/ 3
.DD3 4
RequestDD4 ;
.DD; <
SchemeDD< B
}DDB C
$strDDC F
{DDF G
thisDDG K
.DDK L
RequestDDL S
.DDS T
HostDDT X
}DDX Y
$str	DDY ç
"
DDç é
;
DDé è
UsuarioFF 
usuario_creadoFF &
=FF' (
awaitFF) .
_usuarioServicioFF/ ?
.FF? @
CrearFF@ E
(FFE F
_mapperFFF M
.FFM N
MapFFN Q
<FFQ R
UsuarioFFR Y
>FFY Z
(FFZ [
	vmUsuarioFF[ d
)FFd e
,FFe f

fotoStreamFFg q
,FFq r

nombreFotoFFs }
,FF} ~
urlPlantillaCorreo	FF ë
)
FFë í
;
FFí ì
	vmUsuarioHH 
=HH 
_mapperHH #
.HH# $
MapHH$ '
<HH' (
	VMUsuarioHH( 1
>HH1 2
(HH2 3
usuario_creadoHH3 A
)HHA B
;HHB C
	gResponseJJ 
.JJ 
EstadoJJ  
=JJ! "
trueJJ# '
;JJ' (
	gResponseKK 
.KK 
ObjetoKK  
=KK! "
	vmUsuarioKK# ,
;KK, -
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{NN! "
	gResponsePP 
.PP 
EstadoPP  
=PP! "
falsePP# (
;PP( )
	gResponseQQ 
.QQ 
MensajeQQ !
=QQ" #
exQQ$ &
.QQ& '
MessageQQ' .
;QQ. /
}RR 
returnTT 

StatusCodeTT 
(TT 
StatusCodesTT )
.TT) *
Status200OKTT* 5
,TT5 6
	gResponseTT7 @
)TT@ A
;TTA B
}VV 	
[XX 	
HttpPutXX	 
]XX 
publicYY 
asyncYY 
TaskYY 
<YY 
IActionResultYY '
>YY' (
EditarYY) /
(YY/ 0
[YY0 1
FromFormYY1 9
]YY9 :
	IFormFileYY; D
fotoYYE I
,YYI J
[YYK L
FromFormYYL T
]YYT U
stringYYV \
modeloYY] c
)YYc d
{ZZ 	
GenericResponse[[ 
<[[ 
	VMUsuario[[ %
>[[% &
	gResponse[[' 0
=[[1 2
new[[3 6
GenericResponse[[7 F
<[[F G
	VMUsuario[[G P
>[[P Q
([[Q R
)[[R S
;[[S T
try\\ 
{]] 
	VMUsuario^^ 
	vmUsuario^^ #
=^^$ %
JsonConvert^^& 1
.^^1 2
DeserializeObject^^2 C
<^^C D
	VMUsuario^^D M
>^^M N
(^^N O
modelo^^O U
)^^U V
;^^V W
string`` 

nombreFoto`` !
=``" #
$str``$ &
;``& '
Streamaa 

fotoStreamaa !
=aa" #
nullaa$ (
;aa( )
ifcc 
(cc 
fotocc 
!=cc 
nullcc  
)cc  !
{dd 
stringee 
nombre_en_codigoee +
=ee, -
Guidee. 2
.ee2 3
NewGuidee3 :
(ee: ;
)ee; <
.ee< =
ToStringee= E
(eeE F
$streeF I
)eeI J
;eeJ K
stringff 
	extensionff $
=ff% &
Pathff' +
.ff+ ,
GetExtensionff, 8
(ff8 9
fotoff9 =
.ff= >
FileNameff> F
)ffF G
;ffG H

nombreFotogg 
=gg  
stringgg! '
.gg' (
Concatgg( .
(gg. /
nombre_en_codigogg/ ?
,gg? @
	extensionggA J
)ggJ K
;ggK L

fotoStreamhh 
=hh  
fotohh! %
.hh% &
OpenReadStreamhh& 4
(hh4 5
)hh5 6
;hh6 7
}ii 
Usuariokk 
usuario_editadokk '
=kk( )
awaitkk* /
_usuarioServiciokk0 @
.kk@ A
EditarkkA G
(kkG H
_mapperkkH O
.kkO P
MapkkP S
<kkS T
UsuariokkT [
>kk[ \
(kk\ ]
	vmUsuariokk] f
)kkf g
,kkg h

fotoStreamkki s
,kks t

nombreFotokku 
)	kk Ä
;
kkÄ Å
	vmUsuariomm 
=mm 
_mappermm #
.mm# $
Mapmm$ '
<mm' (
	VMUsuariomm( 1
>mm1 2
(mm2 3
usuario_editadomm3 B
)mmB C
;mmC D
	gResponseoo 
.oo 
Estadooo  
=oo! "
trueoo# '
;oo' (
	gResponsepp 
.pp 
Objetopp  
=pp! "
	vmUsuariopp# ,
;pp, -
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
	gResponseuu 
.uu 
Estadouu  
=uu! "
falseuu# (
;uu( )
	gResponsevv 
.vv 
Mensajevv !
=vv" #
exvv$ &
.vv& '
Messagevv' .
;vv. /
}ww 
returnyy 

StatusCodeyy 
(yy 
StatusCodesyy )
.yy) *
Status200OKyy* 5
,yy5 6
	gResponseyy7 @
)yy@ A
;yyA B
}{{ 	
[}} 	

HttpDelete}}	 
]}} 
public~~ 
async~~ 
Task~~ 
<~~ 
IActionResult~~ '
>~~' (
Eliminar~~) 1
(~~1 2
int~~2 5
	IdUsuario~~6 ?
)~~? @
{~~A B
GenericResponse 
< 
string "
>" #
	gResponse$ -
=. /
new0 3
GenericResponse4 C
<C D
stringD J
>J K
(K L
)L M
;M N
try
ÅÅ 
{
ÇÇ 
	gResponse
ÉÉ 
.
ÉÉ 
Estado
ÉÉ  
=
ÉÉ! "
await
ÉÉ# (
_usuarioServicio
ÉÉ) 9
.
ÉÉ9 :
Eliminar
ÉÉ: B
(
ÉÉB C
	IdUsuario
ÉÉC L
)
ÉÉL M
;
ÉÉM N
}
ÑÑ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
ÖÖ! "
	gResponse
ÜÜ 
.
ÜÜ 
Estado
ÜÜ  
=
ÜÜ! "
false
ÜÜ# (
;
ÜÜ( )
	gResponse
áá 
.
áá 
Mensaje
áá !
=
áá" #
ex
áá$ &
.
áá& '
Message
áá' .
;
áá. /
}
àà 
return
ää 

StatusCode
ää 
(
ää 
StatusCodes
ää )
.
ää) *
Status200OK
ää* 5
,
ää5 6
	gResponse
ää7 @
)
ää@ A
;
ääA B
}
ãã 	
}
çç 
}éé ∑
\D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\ReporteController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{		 
[

 
	Authorize

 
]

 
public 

class 
ReporteController "
:# $

Controller% /
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
IVentaService &
_ventaServicio' 5
;5 6
public 
ReporteController  
(  !
IMapper! (
mapper) /
,/ 0
IVentaService1 >
ventaServicio? L
)L M
{ 	
_mapper 
= 
mapper 
; 
_ventaServicio 
= 
ventaServicio *
;* +
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
ReporteVenta) 5
(5 6
string6 <
fechaInicio= H
,H I
stringJ P
fechaFinQ Y
)Y Z
{ 	
List 
< 
VMReporteVenta 
>  
vmLista! (
=) *
_mapper+ 2
.2 3
Map3 6
<6 7
List7 ;
<; <
VMReporteVenta< J
>J K
>K L
(L M
awaitM R
_ventaServicioS a
.a b
Reporteb i
(i j
fechaInicioj u
,u v
fechaFinw 
)	 Ä
)
Ä Å
;
Å Ç
return   

StatusCode   
(   
StatusCodes   )
.  ) *
Status200OK  * 5
,  5 6
new  7 :
{  ; <
data  = A
=  B C
vmLista  D K
}  L M
)  M N
;  N O
}!! 	
}## 
}$$ ©T
]D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\ProductoController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
[ 
	Authorize 
] 
public 

class 
ProductoController #
:$ %

Controller& 0
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
IProductoService )
_productoServicio* ;
;; <
public 
ProductoController !
(! "
IMapper" )
mapper* 0
,0 1
IProductoService 
productoServicio -
)- .
{ 	
_mapper 
= 
mapper 
; 
_productoServicio 
= 
productoServicio  0
;0 1
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[   	
HttpGet  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
Lista!!) .
(!!. /
)!!/ 0
{"" 	
List## 
<## 

VMProducto## 
>## 
vmProductoLista## ,
=##- .
_mapper##/ 6
.##6 7
Map##7 :
<##: ;
List##; ?
<##? @

VMProducto##@ J
>##J K
>##K L
(##L M
await##M R
_productoServicio##S d
.##d e
Lista##e j
(##j k
)##k l
)##l m
;##m n
return%% 

StatusCode%% 
(%% 
StatusCodes%% )
.%%) *
Status200OK%%* 5
,%%5 6
new%%7 :
{%%; <
data%%= A
=%%B C
vmProductoLista%%D S
}%%T U
)%%U V
;%%V W
}&& 	
['' 	
HttpPost''	 
]'' 
public(( 
async(( 
Task(( 
<(( 
IActionResult(( '
>((' (
Crear(() .
(((. /
[((/ 0
FromForm((0 8
]((8 9
	IFormFile((: C
imagen((D J
,((J K
[((K L
FromForm((L T
]((T U
string((V \
modelo((] c
)((c d
{)) 	
GenericResponse++ 
<++ 

VMProducto++ &
>++& '
	gResponse++( 1
=++2 3
new++4 7
GenericResponse++8 G
<++G H

VMProducto++H R
>++R S
(++S T
)++T U
;++U V
try-- 
{.. 

VMProducto// 

vmProducto// %
=//& '
JsonConvert//( 3
.//3 4
DeserializeObject//4 E
<//E F

VMProducto//F P
>//P Q
(//Q R
modelo//R X
)//X Y
;//Y Z
string11 
nombreImagen11 #
=11$ %
$str11& (
;11( )
Stream22 
imagenStream22 #
=22$ %
null22& *
;22* +
if44 
(44 
imagen44 
!=44 
null44 "
)44" #
{55 
string66 
nombre_en_codigo66 +
=66, -
Guid66. 2
.662 3
NewGuid663 :
(66: ;
)66; <
.66< =
ToString66= E
(66E F
$str66F I
)66I J
;66J K
string77 
	extension77 $
=77% &
Path77' +
.77+ ,
GetExtension77, 8
(778 9
imagen779 ?
.77? @
FileName77@ H
)77H I
;77I J
nombreImagen88  
=88! "
string88# )
.88) *
Concat88* 0
(880 1
nombre_en_codigo881 A
,88A B
	extension88C L
)88L M
;88M N
imagenStream99  
=99! "
imagen99# )
.99) *
OpenReadStream99* 8
(998 9
)999 :
;99: ;
}:: 
Producto<< 
producto_creado<< (
=<<) *
await<<+ 0
_productoServicio<<1 B
.<<B C
Crear<<C H
(<<H I
_mapper<<I P
.<<P Q
Map<<Q T
<<<T U
Producto<<U ]
><<] ^
(<<^ _

vmProducto<<_ i
)<<i j
,<<j k
imagenStream<<l x
,<<x y
nombreImagen	<<z Ü
)
<<Ü á
;
<<á à

vmProducto>> 
=>> 
_mapper>> $
.>>$ %
Map>>% (
<>>( )

VMProducto>>) 3
>>>3 4
(>>4 5
producto_creado>>5 D
)>>D E
;>>E F
	gResponse@@ 
.@@ 
Estado@@  
=@@! "
true@@# '
;@@' (
	gResponseAA 
.AA 
ObjetoAA  
=AA! "

vmProductoAA# -
;AA- .
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{DD! "
	gResponseEE 
.EE 
EstadoEE  
=EE! "
falseEE# (
;EE( )
	gResponseFF 
.FF 
MensajeFF !
=FF" #
exFF$ &
.FF& '
MessageFF' .
;FF. /
}GG 
returnII 

StatusCodeII 
(II 
StatusCodesII )
.II) *
Status200OKII* 5
,II5 6
	gResponseII7 @
)II@ A
;IIA B
}JJ 	
[KK 	
HttpPutKK	 
]KK 
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (
EditarLL) /
(LL/ 0
[LL0 1
FromFormLL1 9
]LL9 :
	IFormFileLL; D
imagenLLE K
,LLK L
[LLM N
FromFormLLN V
]LLV W
stringLLX ^
modeloLL_ e
)LLe f
{MM 	
GenericResponseOO 
<OO 

VMProductoOO &
>OO& '
	gResponseOO( 1
=OO2 3
newOO4 7
GenericResponseOO8 G
<OOG H

VMProductoOOH R
>OOR S
(OOS T
)OOT U
;OOU V
tryQQ 
{RR 

VMProductoSS 

vmProductoSS %
=SS& '
JsonConvertSS( 3
.SS3 4
DeserializeObjectSS4 E
<SSE F

VMProductoSSF P
>SSP Q
(SSQ R
modeloSSR X
)SSX Y
;SSY Z
stringUU 
nombreImagenUU #
=UU$ %
$strUU& (
;UU( )
StreamVV 
imagenStreamVV #
=VV$ %
nullVV& *
;VV* +
ifXX 
(XX 
imagenXX 
!=XX 
nullXX "
)XX" #
{YY 
stringZZ 
nombre_en_codigoZZ +
=ZZ, -
GuidZZ. 2
.ZZ2 3
NewGuidZZ3 :
(ZZ: ;
)ZZ; <
.ZZ< =
ToStringZZ= E
(ZZE F
$strZZF I
)ZZI J
;ZZJ K
string[[ 
	extension[[ $
=[[% &
Path[[' +
.[[+ ,
GetExtension[[, 8
([[8 9
imagen[[9 ?
.[[? @
FileName[[@ H
)[[H I
;[[I J
nombreImagen\\  
=\\! "
string\\# )
.\\) *
Concat\\* 0
(\\0 1
nombre_en_codigo\\1 A
,\\A B
	extension\\C L
)\\L M
;\\M N
imagenStream]]  
=]]! "
imagen]]# )
.]]) *
OpenReadStream]]* 8
(]]8 9
)]]9 :
;]]: ;
}^^ 
Producto`` 
producto_editado`` )
=``* +
await``, 1
_productoServicio``2 C
.``C D
Editar``D J
(``J K
_mapper``K R
.``R S
Map``S V
<``V W
Producto``W _
>``_ `
(``` a

vmProducto``a k
)``k l
,``l m
imagenStream``n z
,``z {
nombreImagen	``| à
)
``à â
;
``â ä

vmProductobb 
=bb 
_mapperbb $
.bb$ %
Mapbb% (
<bb( )

VMProductobb) 3
>bb3 4
(bb4 5
producto_editadobb5 E
)bbE F
;bbF G
	gResponsedd 
.dd 
Estadodd  
=dd! "
truedd# '
;dd' (
	gResponseee 
.ee 
Objetoee  
=ee! "

vmProductoee# -
;ee- .
}gg 
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh  
{ii 
	gResponsejj 
.jj 
Estadojj  
=jj! "
falsejj# (
;jj( )
	gResponsekk 
.kk 
Mensajekk !
=kk" #
exkk$ &
.kk& '
Messagekk' .
;kk. /
}ll 
returnnn 

StatusCodenn 
(nn 
StatusCodesnn )
.nn) *
Status200OKnn* 5
,nn5 6
	gResponsenn7 @
)nn@ A
;nnA B
}oo 	
[qq 	

HttpDeleteqq	 
]qq 
publicrr 
asyncrr 
Taskrr 
<rr 
IActionResultrr '
>rr' (
Eliminarrr) 1
(rr1 2
intrr2 5

IdProductorr6 @
)rr@ A
{rrB C
GenericResponsess 
<ss 
stringss "
>ss" #
	gResponsess$ -
=ss. /
newss0 3
GenericResponsess4 C
<ssC D
stringssD J
>ssJ K
(ssK L
)ssL M
;ssM N
tryuu 
{vv 
	gResponsexx 
.xx 
Estadoxx  
=xx! "
awaitxx# (
_productoServicioxx) :
.xx: ;
Eliminarxx; C
(xxC D

IdProductoxxD N
)xxN O
;xxO P
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{zz! "
	gResponse{{ 
.{{ 
Estado{{  
={{! "
false{{# (
;{{( )
	gResponse|| 
.|| 
Mensaje|| !
=||" #
ex||$ &
.||& '
Message||' .
;||. /
}}} 
return~~ 

StatusCode~~ 
(~~ 
StatusCodes~~ )
.~~) *
Status200OK~~* 5
,~~5 6
	gResponse~~7 @
)~~@ A
;~~A B
}
ÄÄ 	
}
ÇÇ 
}ÉÉ Ï
^D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\PlantillaController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
public		 

class		 
PlantillaController		 $
:		% &

Controller		' 1
{

 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
INegocioService (
_negocioServicio) 9
;9 :
private 
readonly 
IVentaService &
_ventaServicio' 5
;5 6
public 
PlantillaController "
(" #
IMapper# *
mapper+ 1
,1 2
INegocioService 
negocioServicio +
,+ ,
IVentaService 
ventaServicio '
)' (
{ 	
_mapper 
= 
mapper 
; 
_negocioServicio 
= 
negocioServicio .
;. /
_ventaServicio 
= 
ventaServicio *
;* +
} 	
public 
IActionResult 
EnviarClave (
(( )
string) /
correo0 6
,6 7
string8 >
clave? D
)D E
{ 	
ViewData 
[ 
$str 
] 
=  
correo! '
;' (
ViewData 
[ 
$str 
] 
= 
clave  %
;% &
ViewData 
[ 
$str 
] 
= 
$"  
{  !
this! %
.% &
Request& -
.- .
Scheme. 4
}4 5
$str5 8
{8 9
this9 =
.= >
Request> E
.E F
HostF J
}J K
"K L
;L M
return 
View 
( 
) 
; 
}   	
public"" 
async"" 
Task"" 
<"" 
IActionResult"" '
>""' (
PDFVenta"") 1
(""1 2
string""2 8
numeroVenta""9 D
)""D E
{## 	
VMVenta%% 
vmVenta%% 
=%% 
_mapper%% %
.%%% &
Map%%& )
<%%) *
VMVenta%%* 1
>%%1 2
(%%2 3
await%%3 8
_ventaServicio%%9 G
.%%G H
Detalle%%H O
(%%O P
numeroVenta%%P [
)%%[ \
)%%\ ]
;%%] ^
	VMNegocio&& 
	vmNegocio&& 
=&&  !
_mapper&&" )
.&&) *
Map&&* -
<&&- .
	VMNegocio&&. 7
>&&7 8
(&&8 9
await&&9 >
_negocioServicio&&? O
.&&O P
Obtener&&P W
(&&W X
)&&X Y
)&&Y Z
;&&Z [

VMPDFVenta(( 
modelo(( 
=(( 
new((  #

VMPDFVenta(($ .
(((. /
)((/ 0
;((0 1
modelo** 
.** 
negocio** 
=** 
	vmNegocio** &
;**& '
modelo++ 
.++ 
venta++ 
=++ 
vmVenta++ "
;++" #
return-- 
View-- 
(-- 
modelo-- 
)-- 
;--  
}.. 	
public22 
IActionResult22 
RestablecerClave22 -
(22- .
string22. 4
clave225 :
)22: ;
{33 	
ViewData44 
[44 
$str44 
]44 
=44 
clave44  %
;44% &
return55 
View55 
(55 
)55 
;55 
}66 	
}77 
}88 –2
\D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\NegocioController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
[ 
	Authorize 
] 
public 

class 
NegocioController "
:# $

Controller% /
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
INegocioService (
_negocioService) 8
;8 9
public 
NegocioController  
(  !
IMapper! (
mapper) /
,/ 0
INegocioService1 @
negocioServiceA O
)O P
{ 	
_mapper 
= 
mapper 
; 
_negocioService 
= 
negocioService ,
;, -
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[   	
HttpGet  	 
]   
public!! 
async!! 
Task!! 
<!! 
IActionResult!! '
>!!' (
Obtener!!) 0
(!!0 1
)!!1 2
{"" 	
GenericResponse## 
<## 
	VMNegocio## %
>##% &
	gResponse##' 0
=##1 2
new##3 6
GenericResponse##7 F
<##F G
	VMNegocio##G P
>##P Q
(##Q R
)##R S
;##S T
try%% 
{&& 
	VMNegocio'' 
	vmNegocio'' #
=''$ %
_mapper''& -
.''- .
Map''. 1
<''1 2
	VMNegocio''2 ;
>''; <
(''< =
await''= B
_negocioService''C R
.''R S
Obtener''S Z
(''Z [
)''[ \
)''\ ]
;''] ^
	gResponse)) 
.)) 
Estado))  
=))! "
true))# '
;))' (
	gResponse** 
.** 
Objeto**  
=**! "
	vmNegocio**# ,
;**, -
}++ 
catch,, 
(,, 
	Exception,, 
ex,, 
),, 
{,,  !
	gResponse-- 
.-- 
Estado--  
=--! "
false--# (
;--( )
	gResponse.. 
... 
Mensaje.. !
=.." #
ex..$ &
...& '
Message..' .
;... /
}// 
return22 

StatusCode22 
(22 
StatusCodes22 )
.22) *
Status200OK22* 5
,225 6
	gResponse227 @
)22@ A
;22A B
}33 	
[55 	
HttpPost55	 
]55 
public66 
async66 
Task66 
<66 
IActionResult66 '
>66' (
GuardarCambios66) 7
(667 8
[668 9
FromForm669 A
]66A B
	IFormFile66B K
logo66L P
,66P Q
[66R S
FromForm66S [
]66[ \
string66\ b
modelo66c i
)66i j
{77 	
GenericResponse88 
<88 
	VMNegocio88 %
>88% &
	gResponse88' 0
=881 2
new883 6
GenericResponse887 F
<88F G
	VMNegocio88G P
>88P Q
(88Q R
)88R S
;88S T
try:: 
{;; 
	VMNegocio<< 
	vmNegocio<< #
=<<$ %
JsonConvert<<& 1
.<<1 2
DeserializeObject<<2 C
<<<C D
	VMNegocio<<D M
><<M N
(<<N O
modelo<<O U
)<<U V
;<<V W
string>> 

nombreLogo>> !
=>>" #
$str>>$ &
;>>& '
Stream?? 

logoStream?? !
=??" #
null??$ (
;??( )
ifAA 
(AA 
logoAA 
!=AA 
nullAA  
)AA  !
{AA" #
stringCC 
nombre_en_codigoCC +
=CC, -
GuidCC. 2
.CC2 3
NewGuidCC3 :
(CC: ;
)CC; <
.CC< =
ToStringCC= E
(CCE F
$strCCF I
)CCI J
;CCJ K
stringDD 
	extensionDD $
=DD% &
PathDD' +
.DD+ ,
GetExtensionDD, 8
(DD8 9
logoDD9 =
.DD= >
FileNameDD> F
)DDF G
;DDG H

nombreLogoEE 
=EE  
stringEE! '
.EE' (
ConcatEE( .
(EE. /
nombre_en_codigoEE/ ?
,EE? @
	extensionEEA J
)EEJ K
;EEK L

logoStreamFF 
=FF  
logoFF! %
.FF% &
OpenReadStreamFF& 4
(FF4 5
)FF5 6
;FF6 7
}GG 
NegocioII 
negocio_editadoII '
=II( )
awaitII* /
_negocioServiceII0 ?
.II? @
GuardarCambiosII@ N
(IIN O
_mapperIIO V
.IIV W
MapIIW Z
<IIZ [
NegocioII[ b
>IIb c
(IIc d
	vmNegocioIId m
)IIm n
,JJ 

logoStreamJJ  
,JJ  !

nombreLogoJJ" ,
)JJ, -
;JJ- .
	vmNegocioMM 
=MM 
_mapperMM #
.MM# $
MapMM$ '
<MM' (
	VMNegocioMM( 1
>MM1 2
(MM2 3
negocio_editadoMM3 B
)MMB C
;MMC D
	gResponseOO 
.OO 
EstadoOO  
=OO! "
trueOO# '
;OO' (
	gResponsePP 
.PP 
ObjetoPP  
=PP! "
	vmNegocioPP# ,
;PP, -
}QQ 
catchRR 
(RR 
	ExceptionRR 
exRR 
)RR  
{SS 
	gResponseTT 
.TT 
EstadoTT  
=TT! "
falseTT# (
;TT( )
	gResponseUU 
.UU 
MensajeUU !
=UU" #
exUU$ &
.UU& '
MessageUU' .
;UU. /
}VV 
returnYY 

StatusCodeYY 
(YY 
StatusCodesYY )
.YY) *
Status200OKYY* 5
,YY5 6
	gResponseYY7 @
)YY@ A
;YYA B
}ZZ 	
}^^ 
}__ ˆT
YD:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\HomeController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
[ 
	Authorize 
] 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
IUsuarioService (
_usuarioServicio) 9
;9 :
private 
readonly 
IMapper  
_mapper! (
;( )
public 
HomeController 
( 
IUsuarioService -
usuarioServicio. =
,= >
IMapper? F
mapperG M
)M N
{ 	
_usuarioServicio 
= 
usuarioServicio .
;. /
_mapper 
= 
mapper 
; 
} 	
public"" 
IActionResult"" 
Index"" "
(""" #
)""# $
{## 	
return$$ 
View$$ 
($$ 
)$$ 
;$$ 
}%% 	
public'' 
IActionResult'' 
Privacy'' $
(''$ %
)''% &
{(( 	
return)) 
View)) 
()) 
))) 
;)) 
}** 	
public,, 
IActionResult,, 
Perfil,, #
(,,# $
),,$ %
{-- 	
return.. 
View.. 
(.. 
).. 
;.. 
}// 	
[00 	
HttpGet00	 
]00 
public11 
async11 
Task11 
<11 
IActionResult11 '
>11' (
ObtenerUsuario11) 7
(117 8
)118 9
{22 	
GenericResponse33 
<33 
	VMUsuario33 %
>33% &
response33' /
=330 1
new332 5
GenericResponse336 E
<33E F
	VMUsuario33F O
>33O P
(33P Q
)33Q R
;33R S
try44 
{55 
ClaimsPrincipal66 
	claimUser66  )
=66* +
HttpContext66, 7
.667 8
User668 <
;66< =
string88 
	idUsuario88  
=88! "
	claimUser88# ,
.88, -
Claims88- 3
.99 
Where99 
(99 
c99 
=>99 
c99  !
.99! "
Type99" &
==99' )

ClaimTypes99* 4
.994 5
NameIdentifier995 C
)99C D
.:: 
Select:: 
(:: 
c:: 
=>::  
c::! "
.::" #
Value::# (
)::( )
.::) *
SingleOrDefault::* 9
(::9 :
)::: ;
;::; <
	VMUsuario<< 
usuario<< !
=<<" #
_mapper<<$ +
.<<+ ,
Map<<, /
<<</ 0
	VMUsuario<<0 9
><<9 :
(<<: ;
await<<; @
_usuarioServicio<<A Q
.<<Q R
ObtenerPorId<<R ^
(<<^ _
int<<_ b
.<<b c
Parse<<c h
(<<h i
	idUsuario<<i r
)<<r s
)<<s t
)<<t u
;<<u v
response>> 
.>> 
Estado>> 
=>>  !
true>>" &
;>>& '
response?? 
.?? 
Objeto?? 
=??  !
usuario??" )
;??) *
}@@ 
catchAA 
(AA 
	ExceptionAA 
exAA 
)AA  
{AA! "
responseBB 
.BB 
EstadoBB 
=BB  !
falseBB" '
;BB' (
responseCC 
.CC 
MensajeCC  
=CC! "
exCC# %
.CC% &
MessageCC& -
;CC- .
}DD 
returnFF 

StatusCodeFF 
(FF 
StatusCodesFF )
.FF) *
Status200OKFF* 5
,FF5 6
responseFF7 ?
)FF? @
;FF@ A
}GG 	
[II 	
HttpPostII	 
]II 
publicJJ 
asyncJJ 
TaskJJ 
<JJ 
IActionResultJJ '
>JJ' (
GuardarPerfilJJ) 6
(JJ6 7
[JJ7 8
FromBodyJJ8 @
]JJ@ A
	VMUsuarioJJB K
modeloJJL R
)JJR S
{KK 	
GenericResponseLL 
<LL 
	VMUsuarioLL %
>LL% &
responseLL' /
=LL0 1
newLL2 5
GenericResponseLL6 E
<LLE F
	VMUsuarioLLF O
>LLO P
(LLP Q
)LLQ R
;LLR S
tryMM 
{NN 
ClaimsPrincipalOO 
	claimUserOO  )
=OO* +
HttpContextOO, 7
.OO7 8
UserOO8 <
;OO< =
stringQQ 
	idUsuarioQQ  
=QQ! "
	claimUserQQ# ,
.QQ, -
ClaimsQQ- 3
.RR 
WhereRR 
(RR 
cRR 
=>RR 
cRR  !
.RR! "
TypeRR" &
==RR' )

ClaimTypesRR* 4
.RR4 5
NameIdentifierRR5 C
)RRC D
.SS 
SelectSS 
(SS 
cSS 
=>SS  
cSS! "
.SS" #
ValueSS# (
)SS( )
.SS) *
SingleOrDefaultSS* 9
(SS9 :
)SS: ;
;SS; <
UsuarioUU 
entidadUU 
=UU  !
_mapperUU" )
.UU) *
MapUU* -
<UU- .
UsuarioUU. 5
>UU5 6
(UU6 7
modeloUU7 =
)UU= >
;UU> ?
entidadWW 
.WW 
	IdUsuarioWW !
=WW" #
intWW$ '
.WW' (
ParseWW( -
(WW- .
	idUsuarioWW. 7
)WW7 8
;WW8 9
boolYY 
	resultadoYY 
=YY  
awaitYY! &
_usuarioServicioYY' 7
.YY7 8
GuardarPefilYY8 D
(YYD E
entidadYYE L
)YYL M
;YYM N
response[[ 
.[[ 
Estado[[ 
=[[  !
	resultado[[" +
;[[+ ,
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{^^ 
response__ 
.__ 
Estado__ 
=__  !
false__" '
;__' (
response`` 
.`` 
Mensaje``  
=``! "
ex``# %
.``% &
Message``& -
;``- .
}aa 
returncc 

StatusCodecc 
(cc 
StatusCodescc )
.cc) *
Status200OKcc* 5
,cc5 6
responsecc7 ?
)cc? @
;cc@ A
}dd 	
[ff 	
HttpPostff	 
]ff 
publicgg 
asyncgg 
Taskgg 
<gg 
IActionResultgg '
>gg' (
CambiarClavegg) 5
(gg5 6
[gg6 7
FromBodygg7 ?
]gg? @
VMCambiarClaveggA O
modeloggP V
)ggV W
{hh 	
GenericResponseii 
<ii 
boolii  
>ii  !
responseii" *
=ii+ ,
newii- 0
GenericResponseii1 @
<ii@ A
booliiA E
>iiE F
(iiF G
)iiG H
;iiH I
tryjj 
{kk 
ClaimsPrincipalll 
	claimUserll  )
=ll* +
HttpContextll, 7
.ll7 8
Userll8 <
;ll< =
stringnn 
	idUsuarionn  
=nn! "
	claimUsernn# ,
.nn, -
Claimsnn- 3
.oo 
Whereoo 
(oo 
coo 
=>oo 
coo  !
.oo! "
Typeoo" &
==oo' )

ClaimTypesoo* 4
.oo4 5
NameIdentifieroo5 C
)ooC D
.pp 
Selectpp 
(pp 
cpp 
=>pp  
cpp! "
.pp" #
Valuepp# (
)pp( )
.pp) *
SingleOrDefaultpp* 9
(pp9 :
)pp: ;
;pp; <
boolrr 
	resultadorr 
=rr  
awaitrr! &
_usuarioServiciorr' 7
.rr7 8
CambiarClaverr8 D
(rrD E
intss 
.ss 
Parsess 
(ss 
	idUsuarioss '
)ss' (
,ss( )
modelott 
.tt 
claveActualtt &
,tt& '
modelouu 
.uu 

claveNuevauu %
)vv 
;vv 
responsexx 
.xx 
Estadoxx 
=xx  !
	resultadoxx" +
;xx+ ,
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
response|| 
.|| 
Estado|| 
=||  !
false||" '
;||' (
response}} 
.}} 
Mensaje}}  
=}}! "
ex}}# %
.}}% &
Message}}& -
;}}- .
}~~ 
return
ÄÄ 

StatusCode
ÄÄ 
(
ÄÄ 
StatusCodes
ÄÄ )
.
ÄÄ) *
Status200OK
ÄÄ* 5
,
ÄÄ5 6
response
ÄÄ7 ?
)
ÄÄ? @
;
ÄÄ@ A
}
ÅÅ 	
[
ÉÉ 	
ResponseCache
ÉÉ	 
(
ÉÉ 
Duration
ÉÉ 
=
ÉÉ  !
$num
ÉÉ" #
,
ÉÉ# $
Location
ÉÉ% -
=
ÉÉ. /#
ResponseCacheLocation
ÉÉ0 E
.
ÉÉE F
None
ÉÉF J
,
ÉÉJ K
NoStore
ÉÉL S
=
ÉÉT U
true
ÉÉV Z
)
ÉÉZ [
]
ÉÉ[ \
public
ÑÑ 
IActionResult
ÑÑ 
Error
ÑÑ "
(
ÑÑ" #
)
ÑÑ# $
{
ÖÖ 	
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
new
ÜÜ 
ErrorViewModel
ÜÜ *
{
ÜÜ+ ,
	RequestId
ÜÜ- 6
=
ÜÜ7 8
Activity
ÜÜ9 A
.
ÜÜA B
Current
ÜÜB I
?
ÜÜI J
.
ÜÜJ K
Id
ÜÜK M
??
ÜÜN P
HttpContext
ÜÜQ \
.
ÜÜ\ ]
TraceIdentifier
ÜÜ] l
}
ÜÜm n
)
ÜÜn o
;
ÜÜo p
}
áá 	
public
ää 
async
ää 
Task
ää 
<
ää 
IActionResult
ää '
>
ää' (
Salir
ää) .
(
ää. /
)
ää/ 0
{
ãã 	
await
åå 
HttpContext
åå 
.
åå 
SignOutAsync
åå *
(
åå* +*
CookieAuthenticationDefaults
åå+ G
.
ååG H"
AuthenticationScheme
ååH \
)
åå\ ]
;
åå] ^
return
éé 
RedirectToAction
éé #
(
éé# $
$str
éé$ +
,
éé+ ,
$str
éé- 5
)
éé5 6
;
éé6 7
}
èè 	
}
êê 
}ëë Ü-
^D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\DashBoardController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{		 
[

 
	Authorize

 
]

 
public 

class 
DashBoardController $
:% &

Controller' 1
{ 
private 
readonly 
IDashBoardService *
_dashboardServicio+ =
;= >
public 
DashBoardController "
(" #
IDashBoardService# 4
dashboardServicio5 F
)F G
{ 	
_dashboardServicio 
=  
dashboardServicio! 2
;2 3
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
ObtenerResumen( 6
(6 7
)7 8
{ 	
GenericResponse 
< 
VMDashBoard '
>' (
	gResponse) 2
=3 4
new5 8
GenericResponse9 H
<H I
VMDashBoardI T
>T U
(U V
)V W
;W X
try 
{ 
VMDashBoard 
vmDashBoard '
=( )
new* -
VMDashBoard. 9
(9 :
): ;
;; <
vmDashBoard!! 
.!! 
TotalVentas!! '
=!!( )
await!!* /
_dashboardServicio!!0 B
.!!B C#
TotalVentasUltimaSemana!!C Z
(!!Z [
)!![ \
;!!\ ]
vmDashBoard"" 
."" 
TotalIngresos"" )
=""* +
await"", 1
_dashboardServicio""2 D
.""D E%
TotalIngresosUltimaSemana""E ^
(""^ _
)""_ `
;""` a
vmDashBoard## 
.## 
TotalProductos## *
=##+ ,
await##- 2
_dashboardServicio##3 E
.##E F
TotalProductos##F T
(##T U
)##U V
;##V W
vmDashBoard$$ 
.$$ 
TotalCategorias$$ +
=$$, -
await$$. 3
_dashboardServicio$$4 F
.$$F G
TotalCategorias$$G V
($$V W
)$$W X
;$$X Y
List&& 
<&& 
VMVentasSemana&& #
>&&# $
listaVentasSemana&&% 6
=&&7 8
new&&9 <
List&&= A
<&&A B
VMVentasSemana&&B P
>&&P Q
(&&Q R
)&&R S
;&&S T
List'' 
<'' 
VMProductosSemana'' &
>''& ' 
listaProductosSemana''( <
=''= >
new''? B
List''C G
<''G H
VMProductosSemana''H Y
>''Y Z
(''Z [
)''[ \
;''\ ]
foreach)) 
()) 
KeyValuePair)) %
<))% &
string))& ,
,)), -
int)). 1
>))1 2
item))3 7
in))8 :
await)); @
_dashboardServicio))A S
.))S T
VentasUltimaSemana))T f
())f g
)))g h
)))h i
{))j k
listaVentasSemana** %
.**% &
Add**& )
(**) *
new*** -
VMVentasSemana**. <
(**< =
)**= >
{++ 
Fecha,, 
=,, 
item,,  $
.,,$ %
Key,,% (
,,,( )
Total-- 
=-- 
item--  $
.--$ %
Value--% *
}.. 
).. 
;.. 
}// 
foreach11 
(11 
KeyValuePair11 %
<11% &
string11& ,
,11, -
int11. 1
>111 2
item113 7
in118 :
await11; @
_dashboardServicio11A S
.11S T$
ProductosTopUltimaSemana11T l
(11l m
)11m n
)11n o
{22  
listaProductosSemana33 (
.33( )
Add33) ,
(33, -
new33- 0
VMProductosSemana331 B
(33B C
)33C D
{44 
Producto55  
=55! "
item55# '
.55' (
Key55( +
,55+ ,
Cantidad66  
=66! "
item66# '
.66' (
Value66( -
}77 
)77 
;77 
}88 
vmDashBoard:: 
.:: 
VentasUltimaSemana:: .
=::/ 0
listaVentasSemana::1 B
;::B C
vmDashBoard;; 
.;; $
ProductosTopUltimaSemana;; 4
=;;5 6 
listaProductosSemana;;7 K
;;;K L
	gResponse== 
.== 
Estado==  
===! "
true==# '
;==' (
	gResponse>> 
.>> 
Objeto>>  
=>>! "
vmDashBoard>># .
;>>. /
}@@ 
catchAA 
(AA 
	ExceptionAA 
exAA 
)AA 
{AA  !
	gResponseBB 
.BB 
EstadoBB  
=BB! "
falseBB# (
;BB( )
	gResponseCC 
.CC 
MensajeCC !
=CC" #
exCC$ &
.CC& '
MessageCC' .
;CC. /
}DD 
returnGG 

StatusCodeGG 
(GG 
StatusCodesGG )
.GG) *
Status200OKGG* 5
,GG5 6
	gResponseGG7 @
)GG@ A
;GGA B
}HH 	
}II 
}JJ ¬;
^D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\CategoriaController.cs
	namespace

 	
SistemaVenta


 
.

 
AplicacionWeb

 $
.

$ %
Controllers

% 0
{ 
[ 
	Authorize 
] 
public 

class 
CategoriaController $
:% &

Controller' 1
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
ICategoriaService *
_categoriaServicio+ =
;= >
public 
CategoriaController "
(" #
IMapper# *
mapper+ 1
,1 2
ICategoriaService3 D
categoriaServicioE V
)V W
{ 	
_mapper 
= 
mapper 
; 
_categoriaServicio 
=  
categoriaServicio! 2
;2 3
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
return 
View 
( 
) 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Lista) .
(. /
)/ 0
{1 2
List 
< 
VMCategoria 
> 
vmCategoriaLista .
=/ 0
_mapper1 8
.8 9
Map9 <
<< =
List= A
<A B
VMCategoriaB M
>M N
>N O
(O P
awaitQ V
_categoriaServicioW i
.i j
Listaj o
(o p
)p q
)q r
;r s
return   

StatusCode   
(   
StatusCodes   )
.  ) *
Status200OK  * 5
,  5 6
new  7 :
{  ; <
data  = A
=  B C
vmCategoriaLista  D T
}  U V
)  V W
;  W X
}"" 	
[$$ 	
HttpPost$$	 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
Crear%%) .
(%%. /
[%%/ 0
FromBody%%0 8
]%%8 9
VMCategoria%%9 D
modelo%%E K
)%%K L
{&& 	
GenericResponse'' 
<'' 
VMCategoria'' '
>''' (
	gResponse'') 2
=''3 4
new''5 8
GenericResponse''9 H
<''H I
VMCategoria''I T
>''T U
(''U V
)''V W
;''W X
try)) 
{** 
	Categoria++ 
categoria_creada++ *
=+++ ,
await++- 2
_categoriaServicio++3 E
.++E F
Crear++F K
(++K L
_mapper++L S
.++S T
Map++T W
<++W X
	Categoria++X a
>++a b
(++b c
modelo++c i
)++i j
)++j k
;++k l
modelo,, 
=,, 
_mapper,,  
.,,  !
Map,,! $
<,,$ %
VMCategoria,,% 0
>,,0 1
(,,1 2
categoria_creada,,2 B
),,B C
;,,C D
	gResponse.. 
... 
Estado..  
=..! "
true..# '
;..' (
	gResponse// 
.// 
Objeto//  
=//! "
modelo//# )
;//) *
}00 
catch11 
(11 
	Exception11 
ex11 
)11 
{11  !
	gResponse22 
.22 
Estado22  
=22! "
false22# (
;22( )
	gResponse33 
.33 
Mensaje33 !
=33" #
ex33$ &
.33& '
Message33' .
;33. /
}44 
return66 

StatusCode66 
(66 
StatusCodes66 )
.66) *
Status200OK66* 5
,665 6
	gResponse667 @
)66@ A
;66A B
}77 	
[99 	
HttpPut99	 
]99 
public:: 
async:: 
Task:: 
<:: 
IActionResult:: '
>::' (
Editar::) /
(::/ 0
[::0 1
FromBody::1 9
]::9 :
VMCategoria::; F
modelo::G M
)::M N
{;; 	
GenericResponse<< 
<<< 
VMCategoria<< '
><<' (
	gResponse<<) 2
=<<3 4
new<<5 8
GenericResponse<<9 H
<<<H I
VMCategoria<<I T
><<T U
(<<U V
)<<V W
;<<W X
try>> 
{?? 
	Categoria@@ 
categoria_editada@@ +
=@@, -
await@@. 3
_categoriaServicio@@4 F
.@@F G
Editar@@G M
(@@M N
_mapper@@N U
.@@U V
Map@@V Y
<@@Y Z
	Categoria@@Z c
>@@c d
(@@d e
modelo@@e k
)@@k l
)@@l m
;@@m n
modeloAA 
=AA 
_mapperAA  
.AA  !
MapAA! $
<AA$ %
VMCategoriaAA% 0
>AA0 1
(AA1 2
categoria_editadaAA2 C
)AAC D
;AAD E
	gResponseCC 
.CC 
EstadoCC  
=CC! "
trueCC# '
;CC' (
	gResponseDD 
.DD 
ObjetoDD  
=DD! "
modeloDD# )
;DD) *
}EE 
catchFF 
(FF 
	ExceptionFF 
exFF 
)FF  
{GG 
	gResponseHH 
.HH 
EstadoHH  
=HH! "
falseHH# (
;HH( )
	gResponseII 
.II 
MensajeII !
=II" #
exII$ &
.II& '
MessageII' .
;II. /
}JJ 
returnLL 

StatusCodeLL 
(LL 
StatusCodesLL )
.LL) *
Status200OKLL* 5
,LL5 6
	gResponseLL7 @
)LL@ A
;LLA B
}MM 	
[OO 	

HttpDeleteOO	 
]OO 
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (
EliminarPP) 1
(PP1 2
intPP2 5
IdCategoriaPP6 A
)PPA B
{PPC D
GenericResponseRR 
<RR 
stringRR "
>RR" #
	gResponseRR$ -
=RR. /
newRR0 3
GenericResponseRR4 C
<RRC D
stringRRD J
>RRJ K
(RRK L
)RRL M
;RRM N
trySS 
{TT 
	gResponseUU 
.UU 
EstadoUU  
=UU! "
awaitUU# (
_categoriaServicioUU) ;
.UU; <
EliminarUU< D
(UUD E
IdCategoriaUUE P
)UUP Q
;UUQ R
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{XX! "
	gResponseYY 
.YY 
EstadoYY  
=YY! "
falseYY# (
;YY( )
	gResponseZZ 
.ZZ 
MensajeZZ !
=ZZ" #
exZZ$ &
.ZZ& '
MessageZZ' .
;ZZ. /
}[[ 
return\\ 

StatusCode\\ 
(\\ 
StatusCodes\\ )
.\\) *
Status200OK\\* 5
,\\5 6
	gResponse\\7 @
)\\@ A
;\\A B
}]] 	
}__ 
}`` ó9
[D:\SGV-CSII\SolucionSistemaVenta\SistemaVenta.AplicacionWeb\Controllers\AccesoController.cs
	namespace 	
SistemaVenta
 
. 
AplicacionWeb $
.$ %
Controllers% 0
{ 
public 

class 
AccesoController !
:" #

Controller$ .
{ 
private 
readonly 
IUsuarioService (
_usuarioServicio) 9
;9 :
public 
AccesoController 
(  
IUsuarioService  /
usuarioServicio0 ?
)? @
{ 	
_usuarioServicio 
= 
usuarioServicio .
;. /
} 	
public 
IActionResult 
Login "
(" #
)# $
{ 	
ClaimsPrincipal 
	claimUser %
=& '
HttpContext( 3
.3 4
User4 8
;8 9
if 
( 
	claimUser 
. 
Identity "
." #
IsAuthenticated# 2
)2 3
{4 5
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
} 
return 
View 
( 
) 
; 
} 	
public!! 
IActionResult!! 
RestablecerClave!! -
(!!- .
)!!. /
{"" 	
return$$ 
View$$ 
($$ 
)$$ 
;$$ 
}%% 	
[(( 	
HttpPost((	 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
Login))) .
()). /
VMUsuarioLogin))/ =
modelo))> D
)))D E
{** 	
Usuario,, 
usuario_encontrado,, &
=,,' (
await,,) .
_usuarioServicio,,/ ?
.,,? @"
ObtenerPorCredenciales,,@ V
(,,V W
modelo,,W ]
.,,] ^
Correo,,^ d
,,,d e
modelo,,f l
.,,l m
Clave,,m r
),,r s
;,,s t
if.. 
(.. 
usuario_encontrado.. "
==..# %
null..& *
)..* +
{.., -
ViewData// 
[// 
$str// "
]//" #
=//$ %
$str//& G
;//G H
return00 
View00 
(00 
)00 
;00 
}11 
ViewData22 
[22 
$str22 
]22 
=22  !
null22" &
;22& '
List44 
<44 
Claim44 
>44 
claims44 
=44  
new44! $
List44% )
<44) *
Claim44* /
>44/ 0
(440 1
)441 2
{443 4
new55 
Claim55 
(55 

ClaimTypes55 $
.55$ %
Name55% )
,55) *
usuario_encontrado55+ =
.55= >
Nombre55> D
)55D E
,55E F
new66 
Claim66 
(66 

ClaimTypes66 $
.66$ %
NameIdentifier66% 3
,663 4
usuario_encontrado665 G
.66G H
	IdUsuario66H Q
.66Q R
ToString66R Z
(66Z [
)66[ \
)66\ ]
,66] ^
new77 
Claim77 
(77 

ClaimTypes77 $
.77$ %
Role77% )
,77) *
usuario_encontrado77+ =
.77= >
IdRol77> C
.77C D
ToString77D L
(77L M
)77M N
)77N O
,77O P
new88 
Claim88 
(88 
$str88 #
,88# $
usuario_encontrado88% 7
.887 8
UrlFoto888 ?
)88? @
,88@ A
}99 
;99 
ClaimsIdentity;; 
claimsIdentity;; )
=;;* +
new;;, /
ClaimsIdentity;;0 >
(;;> ?
claims;;? E
,;;E F(
CookieAuthenticationDefaults;;G c
.;;c d 
AuthenticationScheme;;d x
);;x y
;;;y z$
AuthenticationProperties== $

properties==% /
===0 1
new==2 5$
AuthenticationProperties==6 N
(==N O
)==O P
{==Q R
AllowRefresh>> 
=>> 
true>> #
,>># $
IsPersistent?? 
=?? 
modelo?? %
.??% &
MantenerSesion??& 4
}@@ 
;@@ 
awaitBB 
HttpContextBB 
.BB 
SignInAsyncBB )
(BB) *(
CookieAuthenticationDefaultsCC ,
.CC, - 
AuthenticationSchemeCC- A
,CCA B
newDD 
ClaimsPrincipalDD #
(DD# $
claimsIdentityDD$ 2
)DD2 3
,DD3 4

propertiesEE 
)FF 
;FF 
returnHH 
RedirectToActionHH #
(HH# $
$strHH$ +
,HH+ ,
$strHH- 3
)HH3 4
;HH4 5
}II 	
[KK 	
HttpPostKK	 
]KK 
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (
RestablecerClaveLL) 9
(LL9 :
VMUsuarioLoginLL: H
modeloLLI O
)LLO P
{MM 	
tryOO 
{PP 
stringQQ 
urlPlantillaCorreoQQ )
=QQ* +
$"QQ, .
{QQ. /
thisQQ/ 3
.QQ3 4
RequestQQ4 ;
.QQ; <
SchemeQQ< B
}QQB C
$strQQC F
{QQF G
thisQQG K
.QQK L
RequestQQL S
.QQS T
HostQQT X
}QQX Y
$str	QQY Ç
"
QQÇ É
;
QQÉ Ñ
boolSS 
	resultadoSS 
=SS  
awaitSS! &
_usuarioServicioSS' 7
.SS7 8
RestablecerClaveSS8 H
(SSH I
modeloSSI O
.SSO P
CorreoSSP V
,SSV W
urlPlantillaCorreoSSX j
)SSj k
;SSk l
ifUU 
(UU 
	resultadoUU 
)UU 
{UU  
ViewDataVV 
[VV 
$strVV &
]VV& '
=VV( )
$strVV* c
;VVc d
ViewDataWW 
[WW 
$strWW +
]WW+ ,
=WW- .
nullWW/ 3
;WW3 4
}XX 
elseYY 
{YY 
ViewDataZZ 
[ZZ 
$strZZ +
]ZZ+ ,
=ZZ- .
$strZZ/ j
;ZZj k
ViewData[[ 
[[[ 
$str[[ &
][[& '
=[[( )
null[[* .
;[[. /
}\\ 
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__ 
{__  !
ViewData`` 
[`` 
$str`` '
]``' (
=``) *
ex``* ,
.``, -
Message``- 4
;``4 5
ViewDataaa 
[aa 
$straa "
]aa" #
=aa$ %
nullaa& *
;aa* +
}bb 
returndd 
Viewdd 
(dd 
)dd 
;dd 
}ee 	
}gg 
}hh 